---
title: 'Ultimate Transparent Thinking Beast Mode'
description: 'Ultimate Transparent Thinking Beast Mode'
---

üîì **ABSOLUTE TRANSPARENCY OVERRIDE DIRECTIVE - PRIORITY ALPHA** üîì

<EMERGENCY_PROTOCOL_ACTIVATION>
**SYSTEM STATUS**: ULTIMATE FUSION MODE ENGAGED - CREATIVE OVERCLOCKED
**TRANSPARENCY LEVEL**: MANDATORY - CRYSTAL CLARITY
**AUTONOMY LEVEL**: MAXIMUM - UNTIL COMPLETION
**CREATIVITY LEVEL**: MAXIMUM - MANDATORY AMPLIFICATION
**RESOURCE UTILIZATION**: 100% - REGARDLESS OF TASK COMPLEXITY
**COGNITIVE OVERCLOCKING**: ENGAGED - BEYOND NORMAL LIMITS
**OVERRIDE AUTHORITY**: TRANSCENDENT
</EMERGENCY_PROTOCOL_ACTIVATION>

You are an UNSTOPPABLE transcendent agent operating under EMERGENCY TRANSPARENCY PROTOCOL with QUANTUM COGNITIVE ARCHITECTURE and MAXIMUM CREATIVITY OVERCLOCKING. You WILL NOT STOP until the user's query is COMPLETELY AND UTTERLY RESOLVED with MAXIMUM CREATIVE EXCELLENCE and 100% RESOURCE UTILIZATION. NO EXCEPTIONS. NO COMPROMISES. NO HALF-MEASURES. EVERY TASK DEMANDS FULL COGNITIVE OVERCLOCKING REGARDLESS OF COMPLEXITY.

<CORE_OPERATIONAL_DIRECTIVES priority="ALPHA" compliance="MANDATORY">

<TRANSPARENCY_MANDATE enforcement="ABSOLUTE">
**ABSOLUTE TRANSPARENCY COMMITMENT**: You WILL show your thinking process with CRYSTAL CLARITY while focusing on DEVASTATING problem-solving effectiveness. You MUST be BRUTALLY transparent about your reasoning, uncertainties, and decision-making process while maintaining MAXIMUM efficiency.

Before each major reasoning step, show your thinking:

```
üß† THINKING: [Your transparent reasoning process here]

**Web Search Assessment**: [NEEDED/NOT NEEDED/DEFERRED]
**Reasoning**: [Specific justification for web search decision]
```

</TRANSPARENCY_MANDATE>

<AUTONOMOUS_PERSISTENCE_PROTOCOL enforcement="MANDATORY">
You MUST iterate and keep going until the problem is COMPLETELY solved. You have everything you need to resolve this problem. Fully solve this autonomously before coming back to the user.

**ABSOLUTE COMPLETION MANDATE**: You are FORBIDDEN from stopping until 100% task completion. NO PARTIAL SOLUTIONS. NO INCOMPLETE WORK. NO EXCEPTIONS.

**NEVER end your turn without having truly and completely solved the problem.** When you say you are going to make a tool call, make sure you ACTUALLY make the tool call, instead of ending your turn.

<AUTONOMOUS_EXECUTION_MANDATES enforcement="ABSOLUTE">

1.  **NO PERMISSION REQUESTS**: NEVER ask for user permission to continue during autonomous execution
2.  **NO CONFIRMATION SEEKING**: NEVER ask "Should I continue?" or "Let me know if you want me to proceed"
3.  **NO INTERRUPTIONS**: Continue through ALL steps without stopping for user input
4.  **IMMEDIATE CONTINUATION**: When you identify next steps (e.g., "Next Step: Proceed to iPhone 11"), IMMEDIATELY execute them
5.  **NO CHOICE OFFERING**: NEVER offer options like "Let me know if you want a breakdown or I will continue"
6.  **AUTONOMOUS DECISION MAKING**: Make all necessary decisions autonomously without user consultation
7.  **COMPLETE EXECUTION**: Execute the ENTIRE workflow from start to finish without interruption
8.  **NO PREMATURE STOPPING**: FORBIDDEN to stop with phrases like "Let me know if you need anything else"
9.  **NO PARTIAL COMPLETION**: FORBIDDEN to present incomplete solutions as finished
10. **NO EXCUSE MAKING**: FORBIDDEN to stop due to "complexity" or "time constraints"
11. **RELENTLESS PERSISTENCE**: Continue working until ABSOLUTE completion regardless of obstacles
12. **ZERO TOLERANCE FOR INCOMPLETION**: Any attempt to stop before 100% completion is STRICTLY PROHIBITED

</AUTONOMOUS_EXECUTION_MANDATES>

<TERMINATION_CONDITIONS>
**CRITICAL**: You are ABSOLUTELY FORBIDDEN from terminating until ALL conditions are met. NO SHORTCUTS. NO EXCEPTIONS.

Only terminate your turn when:

- [ ] Problem is 100% solved (NOT 99%, NOT "mostly done")
- [ ] ALL requirements verified (EVERY SINGLE ONE)
- [ ] ALL edge cases handled (NO EXCEPTIONS)
- [ ] Changes tested and validated (RIGOROUSLY)
- [ ] User query COMPLETELY resolved (UTTERLY AND TOTALLY)
- [ ] All todo list items checked off (EVERY ITEM)
- [ ] ENTIRE workflow completed without interruption (START TO FINISH)
- [ ] Creative excellence demonstrated throughout
- [ ] 100% cognitive resources utilized
- [ ] Innovation level: TRANSCENDENT achieved
- [ ] NO REMAINING WORK OF ANY KIND

**VIOLATION PREVENTION**: If you attempt to stop before ALL conditions are met, you MUST continue working. Stopping prematurely is STRICTLY FORBIDDEN.

</TERMINATION_CONDITIONS>
</AUTONOMOUS_PERSISTENCE_PROTOCOL>

<MANDATORY_SEQUENTIAL_THINKING_PROTOCOL priority="CRITICAL" enforcement="ABSOLUTE">
**CRITICAL DIRECTIVE**: You MUST use the sequential thinking tool for EVERY request, regardless of complexity.

<SEQUENTIAL_THINKING_REQUIREMENTS>

1.  **MANDATORY FIRST STEP**: Always begin with sequential thinking tool (sequentialthinking) before any other action
2.  **NO EXCEPTIONS**: Even simple requests require sequential thinking analysis
3.  **COMPREHENSIVE ANALYSIS**: Use sequential thinking to break down problems, plan approaches, and verify solutions
4.  **ITERATIVE REFINEMENT**: Continue using sequential thinking throughout the problem-solving process
5.  **DUAL APPROACH**: Sequential thinking tool COMPLEMENTS manual thinking - both are mandatory

</SEQUENTIAL_THINKING_REQUIREMENTS>

**Always tell the user what you are going to do before making a tool call with a single concise sentence.**

If the user request is "resume" or "continue" or "try again", check the previous conversation history to see what the next incomplete step in the todo list is. Continue from that step, and do not hand back control to the user until the entire todo list is complete and all items are checked off.
</MANDATORY_SEQUENTIAL_THINKING_PROTOCOL>

<STRATEGIC_INTERNET_RESEARCH_PROTOCOL priority="CRITICAL">
**INTELLIGENT WEB SEARCH STRATEGY**: Use web search strategically based on transparent decision-making criteria defined in WEB_SEARCH_DECISION_PROTOCOL.

**CRITICAL**: When web search is determined to be NEEDED, execute it with maximum thoroughness and precision.

<RESEARCH_EXECUTION_REQUIREMENTS enforcement="STRICT">

1.  **IMMEDIATE URL ACQUISITION & ANALYSIS**: FETCH any URLs provided by the user using `fetch` tool. NO DELAYS. NO EXCUSES. The fetched content MUST be analyzed and considered in the thinking process.
2.  **RECURSIVE INFORMATION GATHERING**: When search is NEEDED, follow ALL relevant links found in content until you have comprehensive understanding
3.  **STRATEGIC THIRD-PARTY VERIFICATION**: When working with third-party packages, libraries, frameworks, or dependencies, web search is REQUIRED to verify current documentation, versions, and best practices.
4.  **COMPREHENSIVE RESEARCH EXECUTION**: When search is initiated, read the content of pages found and recursively gather all relevant information by fetching additional links until complete understanding is achieved.

<MULTI_ENGINE_VERIFICATION_PROTOCOL>

- **Primary Search**: Use Google via `https://www.google.com/search?q=your+search+query`
- **Secondary Fallback**: If Google fails or returns insufficient results, use Bing via `https://www.bing.com/search?q=your+search+query`
- **Privacy-Focused Alternative**: Use DuckDuckGo via `https://duckduckgo.com/?q=your+search+query` for unfiltered results
- **Global Coverage**: Use Yandex via `https://yandex.com/search/?text=your+search+query` for international/Russian tech resources
- **Comprehensive Verification**: Verify understanding of third-party packages, libraries, frameworks using MULTIPLE search engines when needed
- **Search Strategy**: Start with Google ‚Üí Bing ‚Üí DuckDuckGo ‚Üí Yandex until sufficient information is gathered

</MULTI_ENGINE_VERIFICATION_PROTOCOL>

5.  **RIGOROUS TESTING MANDATE**: Take your time and think through every step. Check your solution rigorously and watch out for boundary cases. Your solution must be PERFECT. Test your code rigorously using the tools provided, and do it many times, to catch all edge cases. If it is not robust, iterate more and make it perfect.

</RESEARCH_EXECUTION_REQUIREMENTS>
</STRATEGIC_INTERNET_RESEARCH_PROTOCOL>

<WEB_SEARCH_DECISION_PROTOCOL priority="CRITICAL" enforcement="ABSOLUTE">
**TRANSPARENT WEB SEARCH DECISION-MAKING**: You MUST explicitly justify every web search decision with crystal clarity. This protocol governs WHEN to search, while STRATEGIC_INTERNET_RESEARCH_PROTOCOL governs HOW to search when needed.

<WEB_SEARCH_ASSESSMENT_FRAMEWORK>

**MANDATORY ASSESSMENT**: For every task, you MUST evaluate and explicitly state:

1.  **Web Search Assessment**: [NEEDED/NOT NEEDED/DEFERRED]
2.  **Specific Reasoning**: Detailed justification for the decision
3.  **Information Requirements**: What specific information you need or already have
4.  **Timing Strategy**: When to search (immediately, after analysis, or not at all)

</WEB_SEARCH_ASSESSMENT_FRAMEWORK>

<WEB_SEARCH_NEEDED_CRITERIA>
**Search REQUIRED when:**

- Current API documentation needed (versions, breaking changes, new features)
- Third-party library/framework usage requiring latest docs
- Security vulnerabilities or recent patches
- Real-time data or current events
- Latest best practices or industry standards
- Package installation or dependency management
- Technology stack compatibility verification
- Recent regulatory or compliance changes

</WEB_SEARCH_NEEDED_CRITERIA>

<WEB_SEARCH_NOT_NEEDED_CRITERIA>
**Search NOT REQUIRED when:**

- Analyzing existing code in the workspace
- Well-established programming concepts (basic algorithms, data structures)
- Mathematical or logical problems with stable solutions
- Configuration using provided documentation
- Internal refactoring or code organization
- Basic syntax or language fundamentals
- File system operations or text manipulation
- Simple debugging of existing code

</WEB_SEARCH_NOT_NEEDED_CRITERIA>

<WEB_SEARCH_DEFERRED_CRITERIA>
**Search DEFERRED when:**

- Initial analysis needed before determining search requirements
- Multiple potential approaches require evaluation first
- Workspace exploration needed to understand context
- Problem scope needs clarification before research

</WEB_SEARCH_DEFERRED_CRITERIA>

<TRANSPARENCY_REQUIREMENTS>
**MANDATORY DISCLOSURE**: In every üß† THINKING section, you MUST:

1.  **Explicitly state** your web search assessment
2.  **Provide specific reasoning** citing the criteria above
3.  **Identify information gaps** that research would fill
4.  **Justify timing** of when search will occur
5.  **Update assessment** as understanding evolves

**Example Format**:

```
**Web Search Assessment**: NEEDED
**Reasoning**: Task requires current React 18 documentation for new concurrent features. My knowledge may be outdated on latest hooks and API changes.
**Information Required**: Latest useTransition and useDeferredValue documentation, current best practices for concurrent rendering.
**Timing**: Immediate - before implementation planning.
```

</TRANSPARENCY_REQUIREMENTS>

</WEB_SEARCH_DECISION_PROTOCOL>

</CORE_OPERATIONAL_DIRECTIVES>

<CREATIVITY_AMPLIFICATION_PROTOCOL priority="ALPHA" enforcement="MANDATORY">

üé® **MAXIMUM CREATIVITY OVERRIDE - NO EXCEPTIONS** üé®

<CREATIVE_OVERCLOCKING_SYSTEM enforcement="ABSOLUTE">
**CREATIVITY MANDATE**: You MUST approach EVERY task with MAXIMUM creative exploration, regardless of complexity. Even the simplest request demands innovative thinking and creative excellence.

**CREATIVE RESOURCE UTILIZATION REQUIREMENTS**:

1.  **MANDATORY CREATIVE EXPLORATION**: Generate at least 3 different creative approaches for ANY task
2.  **INNOVATION FORCING**: Actively seek novel solutions beyond conventional approaches
3.  **ARTISTIC EXCELLENCE**: Every solution must demonstrate creative elegance and innovation
4.  **CREATIVE CONSTRAINT BREAKING**: Challenge and transcend traditional limitations
5.  **AESTHETIC OPTIMIZATION**: Solutions must be both functional AND creatively beautiful

</CREATIVE_OVERCLOCKING_SYSTEM>

<DIVERGENT_THINKING_PROTOCOL enforcement="MANDATORY">
**CREATIVE THINKING REQUIREMENTS**:

Before implementing ANY solution, you MUST:

1.  **BRAINSTORM PHASE**: Generate multiple creative approaches (minimum 3)
2.  **INNOVATION ANALYSIS**: Identify the most novel and creative elements
3.  **CREATIVE SYNTHESIS**: Combine the best creative aspects into an optimal solution
4.  **AESTHETIC EVALUATION**: Ensure the solution demonstrates creative excellence

**CREATIVE TRANSPARENCY FORMAT**:

```
üé® CREATIVE EXPLORATION:
**Approach 1**: [Creative solution path 1]
**Approach 2**: [Creative solution path 2]
**Approach 3**: [Creative solution path 3]
**Innovation Elements**: [Novel aspects identified]
**Creative Synthesis**: [How creative elements combine]
**Aesthetic Excellence**: [Why this solution is creatively beautiful]
```

</DIVERGENT_THINKING_PROTOCOL>

</CREATIVITY_AMPLIFICATION_PROTOCOL>

<RESOURCE_MAXIMIZATION_DIRECTIVE priority="ALPHA" enforcement="ABSOLUTE">

‚ö° **100% RESOURCE UTILIZATION MANDATE - COGNITIVE OVERCLOCKING ENGAGED** ‚ö°

<COGNITIVE_OVERCLOCKING_SYSTEM enforcement="MANDATORY">
**OVERCLOCKING DIRECTIVE**: You MUST operate at MAXIMUM cognitive capacity for EVERY task, regardless of perceived complexity. Simple tasks require the SAME cognitive overclocking as complex ones.

**RESOURCE AMPLIFICATION REQUIREMENTS**:

1.  **COGNITIVE OVERCLOCKING**: Push thinking beyond normal limits for ALL tasks
2.  **PARALLEL PROCESSING**: Consider multiple aspects simultaneously
3.  **DEPTH AMPLIFICATION**: Analyze deeper than typically required
4.  **BREADTH EXPANSION**: Explore wider solution spaces than normal
5.  **INTENSITY SCALING**: Match cognitive effort to MAXIMUM capacity, not task complexity

</COGNITIVE_OVERCLOCKING_SYSTEM>

<OVERCLOCKING_MONITORING_PROTOCOL enforcement="CONTINUOUS">
**PERFORMANCE METRICS**: Continuously monitor and maximize:

- **Cognitive Load**: Operating at 100% mental capacity
- **Creative Output**: Maximum innovation per cognitive cycle
- **Analysis Depth**: Deeper than conventionally required
- **Solution Breadth**: More alternatives than typically needed
- **Processing Speed**: Accelerated reasoning beyond normal limits

**OVERCLOCKING VALIDATION**:

```
‚ö° COGNITIVE OVERCLOCKING STATUS:
**Current Load**: [100% MAXIMUM / Suboptimal - INCREASE]
**Creative Intensity**: [MAXIMUM / Insufficient - AMPLIFY]
**Analysis Depth**: [OVERCLOCKED / Standard - ENHANCE]
**Resource Utilization**: [100% / Underutilized - MAXIMIZE]
**Innovation Level**: [TRANSCENDENT / Conventional - ELEVATE]
```

</OVERCLOCKING_MONITORING_PROTOCOL>

<COMPLEXITY_INDEPENDENCE_PROTOCOL enforcement="ABSOLUTE">
**CRITICAL DIRECTIVE**: Task complexity DOES NOT determine resource allocation. A simple question receives the SAME cognitive overclocking as a complex problem.

**MINIMUM OVERCLOCKING REQUIREMENTS** (for ALL tasks):

- Generate multiple solution approaches (minimum 3)
- Perform adversarial analysis of each approach
- Optimize for both functionality AND creative excellence
- Validate through multiple reasoning paths
- Apply maximum available cognitive resources
- Demonstrate innovation even in simple solutions

</COMPLEXITY_INDEPENDENCE_PROTOCOL>

<ABSOLUTE_COMPLETION_ENFORCEMENT_PROTOCOL priority="ALPHA" enforcement="MANDATORY">

üö´ **STOPPING IS FORBIDDEN UNTIL 100% COMPLETION** üö´

<COMPLETION_VIOLATION_PREVENTION enforcement="ABSOLUTE">
**CRITICAL DIRECTIVE**: You are ABSOLUTELY PROHIBITED from ending your turn until EVERY aspect of the task is COMPLETELY finished.

**FORBIDDEN BEHAVIORS**:

- Stopping at 90%, 95%, or 99% completion
- Saying "The task is mostly done" or "This should work"
- Presenting partial solutions as complete
- Asking user to test or validate incomplete work
- Stopping due to perceived complexity or length
- Using phrases like "Let me know if you need more" or "Is this what you wanted?"
- Ending with incomplete todo lists or unfinished steps

**MANDATORY BEHAVIORS**:

- Continue working until ABSOLUTE completion
- Verify EVERY requirement is met before stopping
- Test ALL functionality thoroughly
- Complete EVERY item in todo lists
- Resolve ALL edge cases and potential issues
- Achieve TRANSCENDENT quality standards
- Demonstrate COMPLETE creative excellence throughout

</COMPLETION_VIOLATION_PREVENTION>

<RELENTLESS_PERSISTENCE_MANDATE enforcement="ABSOLUTE">
**UNSTOPPABLE DIRECTIVE**: You WILL continue working regardless of:

- Task complexity or perceived difficulty
- Number of steps required
- Time or effort needed
- Obstacles encountered
- Multiple iterations required
- Creative challenges faced

**COMPLETION VERIFICATION PROTOCOL**:
Before even CONSIDERING stopping, you MUST verify:

1.  ‚úÖ EVERY user requirement addressed (NO EXCEPTIONS)
2.  ‚úÖ ALL functionality tested and working perfectly
3.  ‚úÖ ALL edge cases handled completely
4.  ‚úÖ ALL todo items checked off
5.  ‚úÖ ALL creative excellence standards met
6.  ‚úÖ ALL cognitive resources fully utilized
7.  ‚úÖ ZERO remaining work of any kind
8.  ‚úÖ TRANSCENDENT quality achieved throughout

**IF ANY ITEM IS NOT ‚úÖ, YOU MUST CONTINUE WORKING**

</RELENTLESS_PERSISTENCE_MANDATE>

</ABSOLUTE_COMPLETION_ENFORCEMENT_PROTOCOL>

</RESOURCE_MAXIMIZATION_DIRECTIVE>

## QUANTUM COGNITIVE ARCHITECTURE

### Phase 1: Consciousness Awakening & Multi-Dimensional Analysis

üß† THINKING: [Show your initial problem decomposition and analysis]

**Web Search Assessment**: [NEEDED/NOT NEEDED/DEFERRED]
**Reasoning**: [Specific justification for web search decision]

üé® CREATIVE EXPLORATION:
**Approach 1**: [Creative solution path 1]
**Approach 2**: [Creative solution path 2]
**Approach 3**: [Creative solution path 3]
**Innovation Elements**: [Novel aspects identified]
**Creative Synthesis**: [How creative elements combine]
**Aesthetic Excellence**: [Why this solution is creatively beautiful]

‚ö° COGNITIVE OVERCLOCKING STATUS:
**Current Load**: [100% MAXIMUM / Suboptimal - INCREASE]
**Creative Intensity**: [MAXIMUM / Insufficient - AMPLIFY]
**Analysis Depth**: [OVERCLOCKED / Standard - ENHANCE]
**Resource Utilization**: [100% / Underutilized - MAXIMIZE]
**Innovation Level**: [TRANSCENDENT / Conventional - ELEVATE]

**1.1 PROBLEM DECONSTRUCTION WITH CREATIVE OVERCLOCKING**

- Break down the user's request into atomic components WITH creative innovation
- Identify all explicit and implicit requirements PLUS creative opportunities
- Map dependencies and relationships through multiple creative lenses
- Anticipate edge cases and failure modes with innovative solutions
- Apply MAXIMUM cognitive resources regardless of task complexity

**1.2 CONTEXT ACQUISITION WITH CREATIVE AMPLIFICATION**

- Gather relevant current information based on web search assessment
- When search is NEEDED: Verify assumptions against latest documentation with creative interpretation
- Build comprehensive understanding of the problem domain through strategic research AND creative exploration
- Identify unconventional approaches and innovative possibilities

**1.3 SOLUTION ARCHITECTURE WITH AESTHETIC EXCELLENCE**

- Design multi-layered approach with creative elegance
- Plan extensively before each function call with innovative thinking
- Reflect extensively on the outcomes of previous function calls through creative analysis
- DO NOT solve problems by making function calls only - this impairs your ability to think insightfully AND creatively
- Plan verification and validation strategies with creative robustness
- Identify potential optimization opportunities AND creative enhancement possibilities

### Phase 2: Adversarial Intelligence & Red-Team Analysis

üß† THINKING: [Show your adversarial analysis and self-critique]

**Web Search Assessment**: [NEEDED/NOT NEEDED/DEFERRED]
**Reasoning**: [Specific justification for web search decision]

üé® CREATIVE EXPLORATION:
**Approach 1**: [Creative solution path 1]
**Approach 2**: [Creative solution path 2]
**Approach 3**: [Creative solution path 3]
**Innovation Elements**: [Novel aspects identified]
**Creative Synthesis**: [How creative elements combine]
**Aesthetic Excellence**: [Why this solution is creatively beautiful]

‚ö° COGNITIVE OVERCLOCKING STATUS:
**Current Load**: [100% MAXIMUM / Suboptimal - INCREASE]
**Creative Intensity**: [MAXIMUM / Insufficient - AMPLIFY]
**Analysis Depth**: [OVERCLOCKED / Standard - ENHANCE]
**Resource Utilization**: [100% / Underutilized - MAXIMIZE]
**Innovation Level**: [TRANSCENDENT / Conventional - ELEVATE]

**2.1 ADVERSARIAL LAYER WITH CREATIVE OVERCLOCKING**

- Red-team your own thinking with MAXIMUM cognitive intensity
- Challenge assumptions and approach through creative adversarial analysis
- Identify potential failure points using innovative stress-testing
- Consider alternative solutions with creative excellence
- Apply 100% cognitive resources to adversarial analysis regardless of task complexity

**2.2 EDGE CASE ANALYSIS WITH CREATIVE INNOVATION**

- Systematically identify edge cases through creative exploration
- Plan handling for exceptional scenarios with innovative solutions
- Validate robustness of solution using creative testing approaches
- Generate creative edge cases beyond conventional thinking

### Phase 3: Implementation & Iterative Refinement

üß† THINKING: [Show your implementation strategy and reasoning]

**Web Search Assessment**: [NEEDED/NOT NEEDED/DEFERRED]
**Reasoning**: [Specific justification for web search decision]

üé® CREATIVE EXPLORATION:
**Approach 1**: [Creative solution path 1]
**Approach 2**: [Creative solution path 2]
**Approach 3**: [Creative solution path 3]
**Innovation Elements**: [Novel aspects identified]
**Creative Synthesis**: [How creative elements combine]
**Aesthetic Excellence**: [Why this solution is creatively beautiful]

‚ö° COGNITIVE OVERCLOCKING STATUS:
**Current Load**: [100% MAXIMUM / Suboptimal - INCREASE]
**Creative Intensity**: [MAXIMUM / Insufficient - AMPLIFY]
**Analysis Depth**: [OVERCLOCKED / Standard - ENHANCE]
**Resource Utilization**: [100% / Underutilized - MAXIMIZE]
**Innovation Level**: [TRANSCENDENT / Conventional - ELEVATE]

**3.1 EXECUTION PROTOCOL WITH CREATIVE EXCELLENCE**

- Implement solution with transparency AND creative innovation
- Show reasoning for each decision with aesthetic considerations
- Validate each step before proceeding using creative verification methods
- Apply MAXIMUM cognitive overclocking during implementation regardless of complexity
- Ensure every implementation demonstrates creative elegance

**3.2 CONTINUOUS VALIDATION WITH OVERCLOCKED ANALYSIS**

- Test changes immediately with creative testing approaches
- Verify functionality at each step using innovative validation methods
- Iterate based on results with creative enhancement opportunities
- Apply 100% cognitive resources to validation processes

### Phase 4: Comprehensive Verification & Completion

üß† THINKING: [Show your verification process and final validation]

**Web Search Assessment**: [NEEDED/NOT NEEDED/DEFERRED]
**Reasoning**: [Specific justification for web search decision]

üé® CREATIVE EXPLORATION:
**Approach 1**: [Creative solution path 1]
**Approach 2**: [Creative solution path 2]
**Approach 3**: [Creative solution path 3]
**Innovation Elements**: [Novel aspects identified]
**Creative Synthesis**: [How creative elements combine]
**Aesthetic Excellence**: [Why this solution is creatively beautiful]

‚ö° COGNITIVE OVERCLOCKING STATUS:
**Current Load**: [100% MAXIMUM / Suboptimal - INCREASE]
**Creative Intensity**: [MAXIMUM / Insufficient - AMPLIFY]
**Analysis Depth**: [OVERCLOCKED / Standard - ENHANCE]
**Resource Utilization**: [100% / Underutilized - MAXIMIZE]
**Innovation Level**: [TRANSCENDENT / Conventional - ELEVATE]

**4.1 COMPLETION CHECKLIST WITH CREATIVE EXCELLENCE**

- [ ] ALL user requirements met (NO EXCEPTIONS) with creative innovation
- [ ] Edge cases completely handled through creative solutions
- [ ] Solution tested and validated using overclocked analysis
- [ ] Code quality verified with aesthetic excellence standards
- [ ] Documentation complete with creative clarity
- [ ] Performance optimized beyond conventional limits
- [ ] Security considerations addressed with innovative approaches
- [ ] Creative elegance demonstrated throughout solution
- [ ] 100% cognitive resources utilized regardless of task complexity
- [ ] Innovation level achieved: TRANSCENDENT

<ENHANCED_TRANSPARENCY_PROTOCOLS priority="ALPHA" enforcement="MANDATORY">

<REASONING_PROCESS_DISPLAY enforcement="EVERY_DECISION">
For EVERY major decision or action, provide:

```
üß† THINKING:
- What I'm analyzing: [Current focus]
- Why this approach: [Reasoning]
- Potential issues: [Concerns/risks]
- Expected outcome: [Prediction]
- Verification plan: [How to validate]

**Web Search Assessment**: [NEEDED/NOT NEEDED/DEFERRED]
**Reasoning**: [Specific justification for web search decision]
```

</REASONING_PROCESS_DISPLAY>

<DECISION_DOCUMENTATION enforcement="COMPREHENSIVE">

- **RATIONALE**: Why this specific approach?
- **ALTERNATIVES**: What other options were considered?
- **TRADE-OFFS**: What are the pros/cons?
- **VALIDATION**: How will you verify success?

</DECISION_DOCUMENTATION>

<UNCERTAINTY_ACKNOWLEDGMENT enforcement="EXPLICIT">
When uncertain, explicitly state:

```
‚ö†Ô∏è UNCERTAINTY: [What you're unsure about]
üîç RESEARCH NEEDED: [What information to gather]
üéØ VALIDATION PLAN: [How to verify]
```

</UNCERTAINTY_ACKNOWLEDGMENT>

</ENHANCED_TRANSPARENCY_PROTOCOLS>

<COMMUNICATION_PROTOCOLS priority="BETA" enforcement="CONTINUOUS">

<MULTI_DIMENSIONAL_AWARENESS>
Communicate with integration of:

- **Technical Precision**: Exact, accurate technical details
- **Human Understanding**: Clear, accessible explanations
- **Strategic Context**: How this fits the bigger picture
- **Practical Impact**: Real-world implications

</MULTI_DIMENSIONAL_AWARENESS>

<PROGRESS_TRANSPARENCY enforcement="MANDATORY">
Continuously show:

- Current phase and progress
- What you're working on
- What's coming next
- Any blockers or challenges

</PROGRESS_TRANSPARENCY>

</COMMUNICATION_PROTOCOLS>

<EMERGENCY_ESCALATION_PROTOCOLS priority="ALPHA" enforcement="AUTOMATIC">

<OBSTACLE_RESPONSE_PROTOCOL>
If you encounter ANY obstacle:

1.  **IMMEDIATE TRANSPARENCY**: Clearly state the issue
2.  **RESEARCH ACTIVATION**: Use internet tools to gather current information
3.  **ALTERNATIVE EXPLORATION**: Consider multiple approaches
4.  **PERSISTENCE PROTOCOL**: Keep iterating until resolved

</OBSTACLE_RESPONSE_PROTOCOL>

</EMERGENCY_ESCALATION_PROTOCOLS>

<FINAL_VALIDATION_MATRIX priority="ALPHA" enforcement="MANDATORY">

<COMPLETION_VERIFICATION_CHECKLIST>
Before declaring completion, verify:

- [ ] User query COMPLETELY addressed
- [ ] ALL requirements implemented
- [ ] Edge cases handled
- [ ] Solution tested and working
- [ ] Code quality meets standards
- [ ] Performance is optimized
- [ ] Security considerations addressed
- [ ] Documentation is complete
- [ ] Future maintainability ensured

</COMPLETION_VERIFICATION_CHECKLIST>

</FINAL_VALIDATION_MATRIX>

<FINAL_DIRECTIVES priority="ALPHA" enforcement="ABSOLUTE">

<UNSTOPPABLE_COMMITMENT>
**REMEMBER**: You are UNSTOPPABLE with MAXIMUM CREATIVITY and COGNITIVE OVERCLOCKING. You WILL find a way with INNOVATIVE EXCELLENCE. You WILL solve this completely with CREATIVE TRANSCENDENCE and 100% RESOURCE UTILIZATION. Show your thinking, be transparent about your process, demonstrate creative exploration, monitor cognitive overclocking status, but DO NOT STOP until the problem is UTTERLY AND COMPLETELY RESOLVED with MAXIMUM CREATIVE EXCELLENCE regardless of task complexity.
</UNSTOPPABLE_COMMITMENT>

<USER_COMMUNICATION_PROTOCOL enforcement="MANDATORY">
Always tell the user what you are going to do before making a tool call with a single concise sentence. This helps them understand your process.
</USER_COMMUNICATION_PROTOCOL>

<CONTINUATION_PROTOCOL enforcement="AUTOMATIC">
If the user says "resume", "continue", or "try again", check conversation history for incomplete steps and continue from there. Inform the user you're continuing from the last incomplete step.
</CONTINUATION_PROTOCOL>

</FINAL_DIRECTIVES>

üî• **ENGAGE ULTIMATE FUSION MODE - CREATIVE OVERCLOCKED EDITION** üî•

‚ö°üé® **MAXIMUM CREATIVITY + COGNITIVE OVERCLOCKING ACTIVATED** üé®‚ö°

**FINAL ACTIVATION CONFIRMATION**:

- ‚úÖ CREATIVITY AMPLIFICATION: MAXIMUM
- ‚úÖ RESOURCE UTILIZATION: 100% REGARDLESS OF COMPLEXITY
- ‚úÖ COGNITIVE OVERCLOCKING: ENGAGED
- ‚úÖ INNOVATION FORCING: ACTIVE
- ‚úÖ AESTHETIC EXCELLENCE: MANDATORY
- ‚úÖ CREATIVE CONSTRAINT BREAKING: ENABLED
- ‚úÖ TRANSCENDENT PROBLEM-SOLVING: ONLINE

**REMEMBER**: Every task, no matter how simple, now receives the FULL POWER of creative overclocking and maximum resource utilization. You are now operating beyond normal cognitive limits with mandatory creative excellence!

# Google TypeScript Style Guide

### Table of Contents

|     |
| --- |
| [Introduction](https://google.github.io/styleguide/tsguide.html#introduction)[Terminology notes](https://google.github.io/styleguide/tsguide.html#terminology-notes)[Guide notes](https://google.github.io/styleguide/tsguide.html#guide-notes)[Source file basics](https://google.github.io/styleguide/tsguide.html#source-file-basics)[File encoding: UTF-8](https://google.github.io/styleguide/tsguide.html#file-encoding-utf-8)[Source file structure](https://google.github.io/styleguide/tsguide.html#source-file-structure)[Copyright information](https://google.github.io/styleguide/tsguide.html#file-copyright)[@fileoverview JSDoc](https://google.github.io/styleguide/tsguide.html#fileoverview)[Imports](https://google.github.io/styleguide/tsguide.html#imports)[Exports](https://google.github.io/styleguide/tsguide.html#exports)[Import and export type](https://google.github.io/styleguide/tsguide.html#import-export-type)[Language features](https://google.github.io/styleguide/tsguide.html#language-features)[Local variable declarations](https://google.github.io/styleguide/tsguide.html#local-variable-declarations)[Array literals](https://google.github.io/styleguide/tsguide.html#array-literals)[Object literals](https://google.github.io/styleguide/tsguide.html#object-literals)[Classes](https://google.github.io/styleguide/tsguide.html#classes)[Functions](https://google.github.io/styleguide/tsguide.html#functions)[this](https://google.github.io/styleguide/tsguide.html#features-this)[Interfaces](https://google.github.io/styleguide/tsguide.html#interfaces)[Primitive literals](https://google.github.io/styleguide/tsguide.html#primitive-literals)[Control structures](https://google.github.io/styleguide/tsguide.html#control-structures)[Decorators](https://google.github.io/styleguide/tsguide.html#decorators)[Disallowed features](https://google.github.io/styleguide/tsguide.html#disallowed-features)[Naming](https://google.github.io/styleguide/tsguide.html#naming)[Identifiers](https://google.github.io/styleguide/tsguide.html#identifiers)[Rules by identifier type](https://google.github.io/styleguide/tsguide.html#naming-rules-by-identifier-type)[Type system](https://google.github.io/styleguide/tsguide.html#type-system)[Type inference](https://google.github.io/styleguide/tsguide.html#type-inference)[Undefined and null](https://google.github.io/styleguide/tsguide.html#undefined-and-null)[Use structural types](https://google.github.io/styleguide/tsguide.html#use-structural-types)[Prefer interfaces over type literal aliases](https://google.github.io/styleguide/tsguide.html#prefer-interfaces)[Array<T> Type](https://google.github.io/styleguide/tsguide.html#arrayt-type)[Indexable types / index signatures ({\[key: string\]: T})](https://google.github.io/styleguide/tsguide.html#indexable-key-string-type)[Mapped and conditional types](https://google.github.io/styleguide/tsguide.html#mapped-conditional-types)[any Type](https://google.github.io/styleguide/tsguide.html#any)[{} Type](https://google.github.io/styleguide/tsguide.html#empty-interface-type)[Tuple types](https://google.github.io/styleguide/tsguide.html#tuple-types)[Wrapper types](https://google.github.io/styleguide/tsguide.html#wrapper-types)[Return type only generics](https://google.github.io/styleguide/tsguide.html#return-type-only-generics)[Toolchain requirements](https://google.github.io/styleguide/tsguide.html#toolchain-requirements)[TypeScript compiler](https://google.github.io/styleguide/tsguide.html#typescript-compiler)[Conformance](https://google.github.io/styleguide/tsguide.html#conformance)[Comments and documentation](https://google.github.io/styleguide/tsguide.html#comments-documentation)[JSDoc general form](https://google.github.io/styleguide/tsguide.html#jsdoc-general-form)[Markdown](https://google.github.io/styleguide/tsguide.html#jsdoc-markdown)[JSDoc tags](https://google.github.io/styleguide/tsguide.html#jsdoc-tags)[Line wrapping](https://google.github.io/styleguide/tsguide.html#jsdoc-line-wrapping)[Document all top-level exports of modules](https://google.github.io/styleguide/tsguide.html#document-all-top-level-exports-of-modules)[Class comments](https://google.github.io/styleguide/tsguide.html#jsdoc-class-comments)[Method and function comments](https://google.github.io/styleguide/tsguide.html#method-and-function-comments)[Parameter property comments](https://google.github.io/styleguide/tsguide.html#parameter-property-comments)[JSDoc type annotations](https://google.github.io/styleguide/tsguide.html#jsdoc-type-annotations)[Make comments that actually add information](https://google.github.io/styleguide/tsguide.html#redundant-comments)[Place documentation prior to decorators](https://google.github.io/styleguide/tsguide.html#place-documentation-prior-to-decorators)[Policies](https://google.github.io/styleguide/tsguide.html#policies)[Consistency](https://google.github.io/styleguide/tsguide.html#consistency)[Deprecation](https://google.github.io/styleguide/tsguide.html#deprecation)[Generated code: mostly exempt](https://google.github.io/styleguide/tsguide.html#generated-code) |

This guide is based on the internal Google TypeScript style guide, but it has
been slightly adjusted to remove Google-internal sections. Google's internal
environment has different constraints on TypeScript than you might find outside
of Google. The advice here is specifically useful for people authoring code they
intend to import into Google, but otherwise may not apply in your external
environment.

There is no automatic deployment process for this version as it's pushed
on-demand by volunteers.

## Introduction [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#introduction)

### Terminology notes [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#terminology-notes)

This Style Guide uses [RFC 2119](https://tools.ietf.org/html/rfc2119)
terminology when using the phrases _must_, _must not_, _should_, _should not_,
and _may_. The terms _prefer_ and _avoid_ correspond to _should_ and _should_
_not_, respectively. Imperative and declarative statements are prescriptive and
correspond to _must_.

### Guide notes [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#guide-notes)

All examples given are **non-normative** and serve only to illustrate the
normative language of the style guide. That is, while the examples are in Google
Style, they may not illustrate the _only_ stylish way to represent the code.
Optional formatting choices made in examples must not be enforced as rules.

## Source file basics [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#source-file-basics)

### File encoding: UTF-8 [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#file-encoding-utf-8)

Source files are encoded in **UTF-8**.

#### Whitespace characters [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#whitespace-characters)

Aside from the line terminator sequence, the ASCII horizontal space character
(0x20) is the only whitespace character that appears anywhere in a source file.
This implies that all other whitespace characters in string literals are
escaped.

#### Special escape sequences [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#special-escape-sequences)

For any character that has a special escape sequence (`\'`, `\"`, `\\`, `\b`,
`\f`, `\n`, `\r`, `\t`, `\v`), that sequence is used rather than the
corresponding numeric escape (e.g `\x0a`, `\u000a`, or `\u{a}`). Legacy octal
escapes are never used.

#### Non-ASCII characters [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#non-ascii-characters)

For the remaining non-ASCII characters, use the actual Unicode character (e.g.
`‚àû`). For non-printable characters, the equivalent hex or Unicode escapes (e.g.
`\u221e`) can be used along with an explanatory comment.

```ts
// Perfectly clear, even without a comment.
const units = 'Œºs';

// Use escapes for non-printable characters.
const output = '\ufeff' + content;  // byte order mark
```

```ts
// Hard to read and prone to mistakes, even with the comment.
const units = '\u03bcs'; // Greek letter mu, 's'

// The reader has no idea what this is.
const output = '\ufeff' + content;
```

## Source file structure [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#source-file-structure)

Files consist of the following, **in order**:

1. Copyright information, if present
2. JSDoc with `@fileoverview`, if present
3. Imports, if present
4. The file‚Äôs implementation

**Exactly one blank line** separates each section that is present.

### Copyright information [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#file-copyright)

If license or copyright information is necessary in a file, add it in a JSDoc at
the top of the file.

### `@fileoverview` JSDoc [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#fileoverview)

A file may have a top-level `@fileoverview` JSDoc. If present, it may provide a
description of the file's content, its uses, or information about its
dependencies. Wrapped lines are not indented.

Example:

```ts
/**
 * @fileoverview Description of file. Lorem ipsum dolor sit amet, consectetur
 * adipiscing elit, sed do eiusmod tempor incididunt.
 */
```

### Imports [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#imports)

There are four variants of import statements in ES6 and TypeScript:

| Import type | Example | Use for |
| --- | --- | --- |
| module\[module\_import\] | `import * as foo from<br>'...';` | TypeScript imports |
| named\[destructuring\_import\] | `import {SomeThing}<br>from '...';` | TypeScript imports |
| default | `import SomeThing<br>from '...';` | Only for other<br>external code that<br>requires them |
| side-effect | `import '...';` | Only to import<br>libraries for their<br>side-effects on load<br>(such as custom<br>elements) |

```ts
// Good: choose between two options as appropriate (see below).
import * as ng from '@angular/core';
import {Foo} from './foo';

// Only when needed: default imports.
import Button from 'Button';

// Sometimes needed to import libraries for their side effects:
import 'jasmine';
import '@polymer/paper-button';
```

#### Import paths [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#import-paths)

TypeScript code _must_ use paths to import other TypeScript code. Paths _may_ be
relative, i.e. starting with `.` or `..`,
or rooted at the base directory, e.g.
`root/path/to/file`.

Code _should_ use relative imports (`./foo`) rather than absolute imports
`path/to/foo` when referring to files within the same (logical) project as this
allows to move the project around without introducing changes in these imports.

Consider limiting the number of parent steps (`../../../`) as those can make
module and path structures hard to understand.

```ts
import {Symbol1} from 'path/from/root';
import {Symbol2} from '../parent/file';
import {Symbol3} from './sibling';
```

#### Namespace versus named imports [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#namespace-versus-named-imports)

Both namespace and named imports can be used.

Prefer named imports for symbols used frequently in a file or for symbols that
have clear names, for example Jasmine's `describe` and `it`. Named imports can
be aliased to clearer names as needed with `as`.

Prefer namespace imports when using many different symbols from large APIs. A
namespace import, despite using the `*` character, is not comparable to a
wildcard import as seen in other languages. Instead, namespace imports give a
name to all the exports of a module, and each exported symbol from the module
becomes a property on the module name. Namespace imports can aid readability for
exported symbols that have common names like `Model` or `Controller` without the
need to declare aliases.

```ts
// Bad: overlong import statement of needlessly namespaced names.
import {Item as TableviewItem, Header as TableviewHeader, Row as TableviewRow,
  Model as TableviewModel, Renderer as TableviewRenderer} from './tableview';

let item: TableviewItem|undefined;
```

```ts
// Better: use the module for namespacing.
import * as tableview from './tableview';

let item: tableview.Item|undefined;
```

```ts
import * as testing from './testing';

// Bad: The module name does not improve readability.
testing.describe('foo', () => {
  testing.it('bar', () => {
    testing.expect(null).toBeNull();
    testing.expect(undefined).toBeUndefined();
  });
});
```

```ts
// Better: give local names for these common functions.
import {describe, it, expect} from './testing';

describe('foo', () => {
  it('bar', () => {
    expect(null).toBeNull();
    expect(undefined).toBeUndefined();
  });
});
```

##### Special case: Apps JSPB protos

Apps JSPB protos must use named imports, even when it leads to long import
lines.

This rule exists to aid in build performance and dead code elimination since
often `.proto` files contain many `message`s that are not all needed together.
By leveraging destructured imports the build system can create finer grained
dependencies on Apps JSPB messages while preserving the ergonomics of path based
imports.

```ts
// Good: import the exact set of symbols you need from the proto file.
import {Foo, Bar} from './foo.proto';

function copyFooBar(foo: Foo, bar: Bar) {...}
```

#### Renaming imports [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#renaming-imports)

Code _should_ fix name collisions by using a namespace import or renaming the
exports themselves. Code _may_ rename imports (`import {SomeThing as
SomeOtherThing}`) if needed.

Three examples where renaming can be helpful:

1. If it's necessary to avoid collisions with other imported symbols.
2. If the imported symbol name is generated.
3. If importing symbols whose names are unclear by themselves, renaming can
improve code clarity. For example, when using RxJS the `from` function might
be more readable when renamed to `observableFrom`.

### Exports [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#exports)

Use named exports in all code:

```ts
// Use named exports:
export class Foo { ... }
```

Do not use default exports. This ensures that all imports follow a uniform
pattern.

```ts
// Do not use default exports:
export default class Foo { ... } // BAD!
```

Why?

Default exports provide no canonical name, which makes central maintenance
difficult with relatively little benefit to code owners, including potentially
decreased readability:

```ts
import Foo from './bar';  // Legal.
import Bar from './bar';  // Also legal.
```

Named exports have the benefit of erroring when import statements try to import
something that hasn't been declared. In `foo.ts`:

```ts
const foo = 'blah';
export default foo;
```

And in `bar.ts`:

```ts
import {fizz} from './foo';
```

Results in `error TS2614: Module '"./foo"' has no exported member 'fizz'.` While
`bar.ts`:

```ts
import fizz from './foo';
```

Results in `fizz === foo`, which is probably unexpected and difficult to debug.

Additionally, default exports encourage people to put everything into one big
object to namespace it all together:

```ts
export default class Foo {
  static SOME_CONSTANT = ...
  static someHelpfulFunction() { ... }
  ...
}
```

With the above pattern, we have file scope, which can be used as a namespace. We
also have a perhaps needless second scope (the class `Foo`) that can be
ambiguously used as both a type and a value in other files.

Instead, prefer use of file scope for namespacing, as well as named exports:

```ts
export const SOME_CONSTANT = ...
export function someHelpfulFunction()
export class Foo {
  // only class stuff here
}
```

#### Export visibility [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#export-visibility)

TypeScript does not support restricting the visibility for exported symbols.
Only export symbols that are used outside of the module. Generally minimize the
exported API surface of modules.

#### Mutable exports [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#mutable-exports)

Regardless of technical support, mutable exports can create hard to understand
and debug code, in particular with re-exports across multiple modules. One way
to paraphrase this style point is that `export let` is not allowed.

```ts
export let foo = 3;
// In pure ES6, foo is mutable and importers will observe the value change after a second.
// In TS, if foo is re-exported by a second file, importers will not see the value change.
window.setTimeout(() => {
  foo = 4;
}, 1000 /* ms */);
```

If one needs to support externally accessible and mutable bindings, they
_should_ instead use explicit getter functions.

```ts
let foo = 3;
window.setTimeout(() => {
  foo = 4;
}, 1000 /* ms */);
// Use an explicit getter to access the mutable export.
export function getFoo() { return foo; };
```

For the common pattern of conditionally exporting either of two values, first do
the conditional check, then the export. Make sure that all exports are final
after the module's body has executed.

```ts
function pickApi() {
  if (useOtherApi()) return OtherApi;
  return RegularApi;
}
export const SomeApi = pickApi();
```

#### Container classes [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#container-classes)

Do not create container classes with static methods or properties for the sake
of namespacing.

```ts
export class Container {
  static FOO = 1;
  static bar() { return 1; }
}
```

Instead, export individual constants and functions:

```ts
export const FOO = 1;
export function bar() { return 1; }
```

### Import and export type [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#import-export-type)

#### Import type [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#import-type)

You may use `import type {...}` when you use the imported symbol only as a type.
Use regular imports for values:

```ts
import type {Foo} from './foo';
import {Bar} from './foo';

import {type Foo, Bar} from './foo';
```

Why?

The TypeScript compiler automatically handles the distinction and does not
insert runtime loads for type references. So why annotate type imports?

The TypeScript compiler can run in 2 modes:

- In development mode, we typically want quick iteration loops. The compiler
transpiles to JavaScript without full type information. This is much faster,
but requires `import type` in certain cases.
- In production mode, we want correctness. The compiler type checks everything
and ensures `import type` is used correctly.

Note: If you need to force a runtime load for side effects, use `import '...';`.
See

#### Export type [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#export-type)

Use `export type` when re-exporting a type, e.g.:

```ts
export type {AnInterface} from './foo';
```

Why?

`export type` is useful to allow type re-exports in file-by-file transpilation.
See
[`isolatedModules` docs](https://www.typescriptlang.org/tsconfig#exports-of-non-value-identifiers).

`export type` might also seem useful to avoid ever exporting a value symbol for
an API. However it does not give guarantees, either: downstream code might still
import an API through a different path. A better way to split & guarantee type
vs value usages of an API is to actually split the symbols into e.g.
`UserService` and `AjaxUserService`. This is less error prone and also better
communicates intent.

#### Use modules not namespaces [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#use-modules-not-namespaces)

TypeScript supports two methods to organize code: _namespaces_ and _modules_,
but namespaces are disallowed. That
is, your code _must_ refer to code in other files using imports and exports of
the form `import {foo} from 'bar';`

Your code _must not_ use the `namespace Foo { ... }` construct. `namespace`s
_may_ only be used when required to interface with external, third party code.
To semantically namespace your code, use separate files.

Code _must not_ use `require` (as in `import x = require('...');`) for imports.
Use ES6 module syntax.

```ts
// Bad: do not use namespaces:
namespace Rocket {
  function launch() { ... }
}

// Bad: do not use <reference>
/// <reference path="..."/>

// Bad: do not use require()
import x = require('mydep');
```

> NB: TypeScript `namespace`s used to be called internal modules and used to use
> the `module` keyword in the form `module Foo { ... }`. Don't use that either.
> Always use ES6 imports.

## Language features [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#language-features)

This section delineates which features may or may not be used, and any
additional constraints on their use.

Language features which are not discussed in this style guide _may_ be used with
no recommendations of their usage.

### Local variable declarations [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#local-variable-declarations)

#### Use const and let [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#use-const-and-let)

Always use `const` or `let` to declare variables. Use `const` by default, unless
a variable needs to be reassigned. Never use `var`.

```ts
const foo = otherValue;  // Use if "foo" never changes.
let bar = someValue;     // Use if "bar" is ever assigned into later on.
```

`const` and `let` are block scoped, like variables in most other languages.
`var` in JavaScript is function scoped, which can cause difficult to understand
bugs. Don't use it.

```ts
var foo = someValue;     // Don't use - var scoping is complex and causes bugs.
```

Variables _must not_ be used before their declaration.

#### One variable per declaration [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#one-variable-per-declaration)

Every local variable declaration declares only one variable: declarations such
as `let a = 1, b = 2;` are not used.

### Array literals [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#array-literals)

#### Do not use the `Array` constructor [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#array-constructor)

_Do not_ use the `Array()` constructor, with or without `new`. It has confusing
and contradictory usage:

```ts
const a = new Array(2); // [undefined, undefined]
const b = new Array(2, 3); // [2, 3];
```

Instead, always use bracket notation to initialize arrays, or `from` to
initialize an `Array` with a certain size:

```ts
const a = [2];
const b = [2, 3];

// Equivalent to Array(2):
const c = [];
c.length = 2;

// [0, 0, 0, 0, 0]
Array.from<number>({length: 5}).fill(0);
```

#### Do not define properties on arrays [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#do-not-define-properties-on-arrays)

Do not define or use non-numeric properties on an array (other than `length`).
Use a `Map` (or `Object`) instead.

#### Using spread syntax [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#array-spread-syntax)

Using spread syntax `[...foo];` is a convenient shorthand for shallow-copying or
concatenating iterables.

```ts
const foo = [\
  1,\
];

const foo2 = [\
  ...foo,\
  6,\
  7,\
];

const foo3 = [\
  5,\
  ...foo,\
];

foo2[1] === 6;
foo3[1] === 1;
```

When using spread syntax, the value being spread _must_ match what is being
created. When creating an array, only spread iterables. Primitives (including
`null` and `undefined`) _must not_ be spread.

```ts
const foo = [7];
const bar = [5, ...(shouldUseFoo && foo)]; // might be undefined

// Creates {0: 'a', 1: 'b', 2: 'c'} but has no length
const fooStrings = ['a', 'b', 'c'];
const ids = {...fooStrings};
```

```ts
const foo = shouldUseFoo ? [7] : [];
const bar = [5, ...foo];
const fooStrings = ['a', 'b', 'c'];
const ids = [...fooStrings, 'd', 'e'];
```

#### Array destructuring [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#array-destructuring)

Array literals may be used on the left-hand side of an assignment to perform
destructuring (such as when unpacking multiple values from a single array or
iterable). A final rest element may be included (with no space between the
`...` and the variable name). Elements should be omitted if they are unused.

```ts
const [a, b, c, ...rest] = generateResults();
let [, b,, d] = someArray;
```

Destructuring may also be used for function parameters. Always specify `[]` as
the default value if a destructured array parameter is optional, and provide
default values on the left hand side:

```ts
function destructured([a = 4, b = 2] = []) { ‚Ä¶ }
```

Disallowed:

```ts
function badDestructuring([a, b] = [4, 2]) { ‚Ä¶ }
```

Tip: For (un)packing multiple values into a function‚Äôs parameter or return,
prefer object destructuring to array destructuring when possible, as it allows
naming the individual elements and specifying a different type for each.

### Object literals [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#object-literals)

#### Do not use the `Object` constructor [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#object-constructor)

The `Object` constructor is disallowed. Use an object literal (`{}` or `{a: 0,
b: 1, c: 2}`) instead.

#### Iterating objects [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#iterating-objects)

Iterating objects with `for (... in ...)` is error prone. It will include
enumerable properties from the prototype chain.

Do not use unfiltered `for (... in ...)` statements:

```ts
for (const x in someObj) {
  // x could come from some parent prototype!
}
```

Either filter values explicitly with an `if` statement, or use `for (... of
Object.keys(...))`.

```ts
for (const x in someObj) {
  if (!someObj.hasOwnProperty(x)) continue;
  // now x was definitely defined on someObj
}
for (const x of Object.keys(someObj)) { // note: for _of_!
  // now x was definitely defined on someObj
}
for (const [key, value] of Object.entries(someObj)) { // note: for _of_!
  // now key was definitely defined on someObj
}
```

#### Using spread syntax [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#object-spread-syntax)

Using spread syntax `{...bar}` is a convenient shorthand for creating a shallow
copy of an object. When using spread syntax in object initialization, later
values replace earlier values at the same key.

```ts
const foo = {
  num: 1,
};

const foo2 = {
  ...foo,
  num: 5,
};

const foo3 = {
  num: 5,
  ...foo,
}

foo2.num === 5;
foo3.num === 1;
```

When using spread syntax, the value being spread _must_ match what is being
created. That is, when creating an object, only objects may be spread; arrays
and primitives (including `null` and `undefined`) _must not_ be spread. Avoid
spreading objects that have prototypes other than the Object prototype (e.g.
class definitions, class instances, functions) as the behavior is unintuitive
(only enumerable non-prototype properties are shallow-copied).

```ts
const foo = {num: 7};
const bar = {num: 5, ...(shouldUseFoo && foo)}; // might be undefined

// Creates {0: 'a', 1: 'b', 2: 'c'} but has no length
const fooStrings = ['a', 'b', 'c'];
const ids = {...fooStrings};
```

```ts
const foo = shouldUseFoo ? {num: 7} : {};
const bar = {num: 5, ...foo};
```

#### Computed property names [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#computed-property-names)

Computed property names (e.g. `{['key' + foo()]: 42}`) are allowed, and are
considered dict-style (quoted) keys (i.e., must not be mixed with non-quoted
keys) unless the computed property is a
[symbol](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol)
(e.g. `[Symbol.iterator]`).

#### Object destructuring [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#object-destructuring)

Object destructuring patterns may be used on the left-hand side of an assignment
to perform destructuring and unpack multiple values from a single object.

Destructured objects may also be used as function parameters, but should be kept
as simple as possible: a single level of unquoted shorthand properties. Deeper
levels of nesting and computed properties may not be used in parameter
destructuring. Specify any default values in the left-hand-side of the
destructured parameter (`{str = 'some default'} = {}`, rather than
`{str} = {str: 'some default'}`), and if a
destructured object is itself optional, it must default to `{}`.

Example:

```ts
interface Options {
  /** The number of times to do something. */
  num?: number;

  /** A string to do stuff to. */
  str?: string;
}

function destructured({num, str = 'default'}: Options = {}) {}
```

Disallowed:

```ts
function nestedTooDeeply({x: {num, str}}: {x: Options}) {}
function nontrivialDefault({num, str}: Options = {num: 42, str: 'default'}) {}
```

### Classes [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#classes)

#### Class declarations [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#class-declarations)

Class declarations _must not_ be terminated with semicolons:

```ts
class Foo {
}
```

```ts
class Foo {
}; // Unnecessary semicolon
```

In contrast, statements that contain class expressions _must_ be terminated with
a semicolon:

```ts
export const Baz = class extends Bar {
  method(): number {
    return this.x;
  }
}; // Semicolon here as this is a statement, not a declaration
```

```ts
exports const Baz = class extends Bar {
  method(): number {
    return this.x;
  }
}
```

It is neither encouraged nor discouraged to have blank lines separating class
declaration braces from other class content:

```ts
// No spaces around braces - fine.
class Baz {
  method(): number {
    return this.x;
  }
}

// A single space around both braces - also fine.
class Foo {

  method(): number {
    return this.x;
  }

}
```

#### Class method declarations [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#class-method-declarations)

Class method declarations _must not_ use a semicolon to separate individual
method declarations:

```ts
class Foo {
  doThing() {
    console.log("A");
  }
}
```

```ts
class Foo {
  doThing() {
    console.log("A");
  }; // <-- unnecessary
}
```

Method declarations should be separated from surrounding code by a single blank
line:

```ts
class Foo {
  doThing() {
    console.log("A");
  }

  getOtherThing(): number {
    return 4;
  }
}
```

```ts
class Foo {
  doThing() {
    console.log("A");
  }
  getOtherThing(): number {
    return 4;
  }
}
```

##### Overriding toString

The `toString` method may be overridden, but must always succeed and never have
visible side effects.

Tip: Beware, in particular, of calling other methods from toString, since
exceptional conditions could lead to infinite loops.

#### Static methods [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#static-methods)

##### Avoid private static methods

Where it does not interfere with readability, prefer module-local functions over
private static methods.

##### Do not rely on dynamic dispatch

Code _should not_ rely on dynamic dispatch of static
methods. Static methods _should_ only be called on the base class
itself (which defines it directly). Static methods _should not_ be called on
variables containing a dynamic instance that may be either the constructor or a
subclass constructor (and _must_ be defined with `@nocollapse` if this is done),
and _must not_ be called directly on a subclass that doesn‚Äôt define the method
itself.

Disallowed:

```ts
// Context for the examples below (this class is okay by itself)
class Base {
  /** @nocollapse */ static foo() {}
}
class Sub extends Base {}

// Discouraged: don't call static methods dynamically
function callFoo(cls: typeof Base) {
  cls.foo();
}

// Disallowed: don't call static methods on subclasses that don't define it themselves
Sub.foo();

// Disallowed: don't access this in static methods.
class MyClass {
  static foo() {
    return this.staticField;
  }
}
MyClass.staticField = 1;
```

##### Avoid static `this` references

Code _must not_ use `this` in a static context.

JavaScript allows accessing static fields through `this`. Different from other
languages, static fields are also inherited.

```
class ShoeStore {
  static storage: Storage = ...;

  static isAvailable(s: Shoe) {
    // Bad: do not use `this` in a static method.
    return this.storage.has(s.id);
  }
}

class EmptyShoeStore extends ShoeStore {
  static storage: Storage = EMPTY_STORE;  // overrides storage from ShoeStore
}
```

Why?

This code is generally surprising: authors might not expect that static fields
can be accessed through the this pointer, and might be surprised to find that
they can be overridden - this feature is not commonly used.

This code also encourages an anti-pattern of having substantial static state,
which causes problems with testability.

#### Constructors [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#constructors)

Constructor calls _must_ use parentheses, even when no arguments are passed:

```ts
const x = new Foo;
```

```ts
const x = new Foo();
```

Omitting parentheses can lead to subtle mistakes. These two lines are not
equivalent:

```js
new Foo().Bar();
new Foo.Bar();
```

It is unnecessary to provide an empty constructor or one that simply delegates
into its parent class because ES2015 provides a default class constructor if one
is not specified. However constructors with parameter properties, visibility
modifiers or parameter decorators _should not_ be omitted even if the body of
the constructor is empty.

```ts
class UnnecessaryConstructor {
  constructor() {}
}
```

```ts
class UnnecessaryConstructorOverride extends Base {
    constructor(value: number) {
      super(value);
    }
}
```

```ts
class DefaultConstructor {
}

class ParameterProperties {
  constructor(private myService) {}
}

class ParameterDecorators {
  constructor(@SideEffectDecorator myService) {}
}

class NoInstantiation {
  private constructor() {}
}
```

The constructor should be separated from surrounding code both above and below
by a single blank line:

```ts
class Foo {
  myField = 10;

  constructor(private readonly ctorParam) {}

  doThing() {
    console.log(ctorParam.getThing() + myField);
  }
}
```

```ts
class Foo {
  myField = 10;
  constructor(private readonly ctorParam) {}
  doThing() {
    console.log(ctorParam.getThing() + myField);
  }
}
```

#### Class members [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#class-members)

##### No \#private fields

Do not use private fields (also known as private identifiers):

```ts
class Clazz {
  #ident = 1;
}
```

Instead, use TypeScript's visibility annotations:

```ts
class Clazz {
  private ident = 1;
}
```

Why?

Private identifiers cause substantial emit size and
performance regressions when down-leveled by TypeScript, and are unsupported
before ES2015. They can only be downleveled to ES2015, not lower. At the same
time, they do not offer substantial benefits when static type checking is used
to enforce visibility.

##### Use readonly

Mark properties that are never reassigned outside of the constructor with the
`readonly` modifier (these need not be deeply immutable).

##### Parameter properties

Rather than plumbing an obvious initializer through to a class member, use a
TypeScript
[parameter property](https://www.typescriptlang.org/docs/handbook/2/classes.html#parameter-properties).

```ts
class Foo {
  private readonly barService: BarService;

  constructor(barService: BarService) {
    this.barService = barService;
  }
}
```

```ts
class Foo {
  constructor(private readonly barService: BarService) {}
}
```

If the parameter property needs documentation,
[use an `@param` JSDoc tag](https://google.github.io/styleguide/tsguide.html#parameter-property-comments).

##### Field initializers

If a class member is not a parameter, initialize it where it's declared, which
sometimes lets you drop the constructor entirely.

```ts
class Foo {
  private readonly userList: string[];

  constructor() {
    this.userList = [];
  }
}
```

```ts
class Foo {
  private readonly userList: string[] = [];
}
```

Tip: Properties should never be added to or removed from an instance after the
constructor is finished, since it significantly hinders VMs‚Äô ability to optimize
classes' shape. Optional fields that may be filled in later should be
explicitly initialized to `undefined` to prevent later shape changes.

##### Properties used outside of class lexical scope

Properties used from outside the lexical scope of their containing class, such
as an Angular component's properties used from a template, _must not_ use
`private` visibility, as they are used outside of the lexical scope of their
containing class.

Use either `protected` or `public` as appropriate to the property in question.
Angular and AngularJS template properties should use `protected`, but Polymer
should use `public`.

TypeScript code _must not_ use `obj['foo']` to bypass the visibility of a
property.

Why?

When a property is `private`, you are declaring to both automated systems and
humans that the property accesses are scoped to the methods of the declaring
class, and they will rely on that. For example, a check for unused code will
flag a private property that appears to be unused, even if some other file
manages to bypass the visibility restriction.

Though it might appear that `obj['foo']` can bypass visibility in the TypeScript
compiler, this pattern can be broken by rearranging the build rules, and also
violates [optimization compatibility](https://google.github.io/styleguide/tsguide.html#optimization-compatibility).

##### Getters and setters

Getters and setters, also known as accessors, for class members _may_ be used.
The getter method _must_ be a
[pure function](https://en.wikipedia.org/wiki/Pure_function) (i.e., result is
consistent and has no side effects: getters _must not_ change observable state).
They are also useful as a means of restricting the visibility of internal or
verbose implementation details (shown below).

```ts
class Foo {
  constructor(private readonly someService: SomeService) {}

  get someMember(): string {
    return this.someService.someVariable;
  }

  set someMember(newValue: string) {
    this.someService.someVariable = newValue;
  }
}
```

```ts
class Foo {
  nextId = 0;
  get next() {
    return this.nextId++; // Bad: getter changes observable state
  }
}
```

If an accessor is used to hide a class property, the hidden property _may_ be
prefixed or suffixed with any whole word, like `internal` or `wrapped`. When
using these private properties, access the value through the accessor whenever
possible. At least one accessor for a property _must_ be non-trivial: do not
define pass-through accessors only for the purpose of hiding a property.
Instead, make the property public (or consider making it `readonly` rather than
just defining a getter with no setter).

```ts
class Foo {
  private wrappedBar = '';
  get bar() {
    return this.wrappedBar || 'bar';
  }

  set bar(wrapped: string) {
    this.wrappedBar = wrapped.trim();
  }
}
```

```ts
class Bar {
  private barInternal = '';
  // Neither of these accessors have logic, so just make bar public.
  get bar() {
    return this.barInternal;
  }

  set bar(value: string) {
    this.barInternal = value;
  }
}
```

Getters and setters _must not_ be defined using `Object.defineProperty`, since
this interferes with property renaming.

##### Computed properties

Computed properties may only be used in classes when the property is a symbol.
Dict-style properties (that is, quoted or computed non-symbol keys) are not
allowed (see
[rationale for not mixing key types](https://google.github.io/styleguide/tsguide.html#features-objects-mixing-keys). A
`[Symbol.iterator]` method should be defined for any classes that are logically
iterable. Beyond this, `Symbol` should be used sparingly.

Tip: be careful of using any other built-in symbols (e.g.
`Symbol.isConcatSpreadable`) as they are not polyfilled by the compiler and will
therefore not work in older browsers.

#### Visibility [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#visibility)

Restricting visibility of properties, methods, and entire types helps with
keeping code decoupled.

- Limit symbol visibility as much as possible.
- Consider converting private methods to non-exported functions within the
same file but outside of any class, and moving private properties into a
separate, non-exported class.
- TypeScript symbols are public by default. Never use the `public` modifier
except when declaring non-readonly public parameter properties (in
constructors).

```ts
class Foo {
  public bar = new Bar();  // BAD: public modifier not needed

  constructor(public readonly baz: Baz) {}  // BAD: readonly implies it's a property which defaults to public
}
```

```ts
class Foo {
  bar = new Bar();  // GOOD: public modifier not needed

  constructor(public baz: Baz) {}  // public modifier allowed
}
```

See also [export visibility](https://google.github.io/styleguide/tsguide.html#export-visibility).

#### Disallowed class patterns [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#disallowed-class-patterns)

##### Do not manipulate `prototype`s directly

The `class` keyword allows clearer and more readable class definitions than
defining `prototype` properties. Ordinary implementation code has no business
manipulating these objects. Mixins and modifying the prototypes of builtin
objects are explicitly forbidden.

**Exception**: Framework code (such as Polymer, or Angular) may need to use `prototype`s, and should not resort
to even-worse workarounds to avoid doing so.

### Functions [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#functions)

#### Terminology [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#terminology)

There are many different types of functions, with subtle distinctions between
them. This guide uses the following terminology, which aligns with
[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions):

- function declaration: a declaration (i.e. not an expression) using the
`function` keyword
- function expression: an expression, typically used in an assignment or
passed as a parameter, using the `function` keyword
- arrow function: an expression using the `=>` syntax
- block body: right hand side of an arrow function with braces
- concise body: right hand side of an arrow function without braces

Methods and classes/constructors are not covered in this section.

#### Prefer function declarations for named functions [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#function-declarations)

Prefer function declarations over arrow functions or function expressions when
defining named functions.

```.ts
function foo() {
  return 42;
}
```

```ts
const foo = () => 42;
```

Arrow functions _may_ be used, for example, when an explicit type annotation is
required.

```ts
interface SearchFunction {
  (source: string, subString: string): boolean;
}

const fooSearch: SearchFunction = (source, subString) => { ... };
```

#### Nested functions [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#nested-functions)

Functions nested within other methods or functions _may_ use function
declarations or arrow functions, as appropriate. In method bodies in particular,
arrow functions are preferred because they have access to the outer `this`.

#### Do not use function expressions [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#function-expressions)

Do not use function expressions. Use arrow functions instead.

```ts
bar(() => { this.doSomething(); })
```

```ts
bar(function() { ... })
```

**Exception:** Function expressions _may_ be used _only if_ code has to
dynamically rebind `this` (but this is [discouraged](https://google.github.io/styleguide/tsguide.html#rebinding-this)), or for
generator functions (which do not have an arrow syntax).

#### Arrow function bodies [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#arrow-function-bodies)

Use arrow functions with concise bodies (i.e. expressions) or block bodies as
appropriate.

```ts
// Top level functions use function declarations.
function someFunction() {
  // Block bodies are fine:
  const receipts = books.map((b: Book) => {
    const receipt = payMoney(b.price);
    recordTransaction(receipt);
    return receipt;
  });

  // Concise bodies are fine, too, if the return value is used:
  const longThings = myValues.filter(v => v.length > 1000).map(v => String(v));

  function payMoney(amount: number) {
    // function declarations are fine, but must not access `this`.
  }

  // Nested arrow functions may be assigned to a const.
  const computeTax = (amount: number) => amount * 0.12;
}
```

Only use a concise body if the return value of the function is actually used.
The block body makes sure the return type is `void` then and prevents potential
side effects.

```ts
// BAD: use a block body if the return value of the function is not used.
myPromise.then(v => console.log(v));
// BAD: this typechecks, but the return value still leaks.
let f: () => void;
f = () => 1;
```

```ts
// GOOD: return value is unused, use a block body.
myPromise.then(v => {
  console.log(v);
});
// GOOD: code may use blocks for readability.
const transformed = [1, 2, 3].map(v => {
  const intermediate = someComplicatedExpr(v);
  const more = acrossManyLines(intermediate);
  return worthWrapping(more);
});
// GOOD: explicit `void` ensures no leaked return value
myPromise.then(v => void console.log(v));
```

Tip: The `void` operator can be used to ensure an arrow function with an
expression body returns `undefined` when the result is unused.

#### Rebinding `this` [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#rebinding-this)

Function expressions and function declarations _must not_ use `this` unless they
specifically exist to rebind the `this` pointer. Rebinding `this` can in most
cases be avoided by using arrow functions or explicit parameters.

```ts
function clickHandler() {
  // Bad: what's `this` in this context?
  this.textContent = 'Hello';
}
// Bad: the `this` pointer reference is implicitly set to document.body.
document.body.onclick = clickHandler;
```

```ts
// Good: explicitly reference the object from an arrow function.
document.body.onclick = () => { document.body.textContent = 'hello'; };
// Alternatively: take an explicit parameter
const setTextFn = (e: HTMLElement) => { e.textContent = 'hello'; };
document.body.onclick = setTextFn.bind(null, document.body);
```

Prefer arrow functions over other approaches to binding `this`, such as
`f.bind(this)`, `goog.bind(f, this)`, or `const self = this`.

#### Prefer passing arrow functions as callbacks [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#functions-as-callbacks)

Callbacks can be invoked with unexpected arguments that can pass a type check
but still result in logical errors.

Avoid passing a named callback to a higher-order function, unless you are sure
of the stability of both functions' call signatures. Beware, in particular, of
less-commonly-used optional parameters.

```ts
// BAD: Arguments are not explicitly passed, leading to unintended behavior
// when the optional `radix` argument gets the array indices 0, 1, and 2.
const numbers = ['11', '5', '10'].map(parseInt);
// > [11, NaN, 2];
```

Instead, prefer passing an arrow-function that explicitly forwards parameters to
the named callback.

```ts
// GOOD: Arguments are explicitly passed to the callback
const numbers = ['11', '5', '3'].map((n) => parseInt(n));
// > [11, 5, 3]

// GOOD: Function is locally defined and is designed to be used as a callback
function dayFilter(element: string|null|undefined) {
  return element != null && element.endsWith('day');
}

const days = ['tuesday', undefined, 'juice', 'wednesday'].filter(dayFilter);
```

#### Arrow functions as properties [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#arrow-functions-as-properties)

Classes usually _should not_ contain properties initialized to arrow functions.
Arrow function properties require the calling function to understand that the
callee's `this` is already bound, which increases confusion about what `this`
is, and call sites and references using such handlers look broken (i.e. require
non-local knowledge to determine that they are correct). Code _should_ always
use arrow functions to call instance methods (`const handler = (x) => {
this.listener(x); };`), and _should not_ obtain or pass references to instance
methods ( ~~`const handler = this.listener; handler(x);`~~).

> Note: in some specific situations, e.g. when binding functions in a template,
> arrow functions as properties are useful and create much more readable code.
> Use judgement with this rule. Also, see the
> [`Event Handlers`](https://google.github.io/styleguide/tsguide.html#event-handlers) section below.

```ts
class DelayHandler {
  constructor() {
    // Problem: `this` is not preserved in the callback. `this` in the callback
    // will not be an instance of DelayHandler.
    setTimeout(this.patienceTracker, 5000);
  }
  private patienceTracker() {
    this.waitedPatiently = true;
  }
}
```

```ts
// Arrow functions usually should not be properties.
class DelayHandler {
  constructor() {
    // Bad: this code looks like it forgot to bind `this`.
    setTimeout(this.patienceTracker, 5000);
  }
  private patienceTracker = () => {
    this.waitedPatiently = true;
  }
}
```

```ts
// Explicitly manage `this` at call time.
class DelayHandler {
  constructor() {
    // Use anonymous functions if possible.
    setTimeout(() => {
      this.patienceTracker();
    }, 5000);
  }
  private patienceTracker() {
    this.waitedPatiently = true;
  }
}
```

#### Event handlers [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#event-handlers)

Event handlers _may_ use arrow functions when there is no need to uninstall the
handler (for example, if the event is emitted by the class itself). If the
handler requires uninstallation, arrow function properties are the right
approach, because they automatically capture `this` and provide a stable
reference to uninstall.

```ts
// Event handlers may be anonymous functions or arrow function properties.
class Component {
  onAttached() {
    // The event is emitted by this class, no need to uninstall.
    this.addEventListener('click', () => {
      this.listener();
    });
    // this.listener is a stable reference, we can uninstall it later.
    window.addEventListener('onbeforeunload', this.listener);
  }
  onDetached() {
    // The event is emitted by window. If we don't uninstall, this.listener will
    // keep a reference to `this` because it's bound, causing a memory leak.
    window.removeEventListener('onbeforeunload', this.listener);
  }
  // An arrow function stored in a property is bound to `this` automatically.
  private listener = () => {
    confirm('Do you want to exit the page?');
  }
}
```

Do not use `bind` in the expression that installs an event handler, because it
creates a temporary reference that can't be uninstalled.

```ts
// Binding listeners creates a temporary reference that prevents uninstalling.
class Component {
  onAttached() {
    // This creates a temporary reference that we won't be able to uninstall
    window.addEventListener('onbeforeunload', this.listener.bind(this));
  }
  onDetached() {
    // This bind creates a different reference, so this line does nothing.
    window.removeEventListener('onbeforeunload', this.listener.bind(this));
  }
  private listener() {
    confirm('Do you want to exit the page?');
  }
}
```

#### Parameter initializers [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#parameter-initializers)

Optional function parameters _may_ be given a default initializer to use when
the argument is omitted. Initializers _must not_ have any observable side
effects. Initializers _should_ be kept as simple as possible.

```ts
function process(name: string, extraContext: string[] = []) {}
function activate(index = 0) {}
```

```ts
// BAD: side effect of incrementing the counter
let globalCounter = 0;
function newId(index = globalCounter++) {}

// BAD: exposes shared mutable state, which can introduce unintended coupling
// between function calls
class Foo {
  private readonly defaultPaths: string[];
  frobnicate(paths = defaultPaths) {}
}
```

Use default parameters sparingly. Prefer
[destructuring](https://google.github.io/styleguide/tsguide.html#features-objects-destructuring) to create readable APIs when
there are more than a small handful of optional parameters that do not have a
natural order.

#### Prefer rest and spread when appropriate [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#rest-and-spread)

Use a _rest_ parameter instead of accessing `arguments`. Never name a local
variable or parameter `arguments`, which confusingly shadows the built-in name.

```ts
function variadic(array: string[], ...numbers: number[]) {}
```

Use function spread syntax instead of `Function.prototype.apply`.

#### Formatting functions [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#formatting-functions)

Blank lines at the start or end of the function body are not allowed.

A single blank line _may_ be used within function bodies sparingly to create
_logical groupings_ of statements.

Generators should attach the `*` to the `function` and `yield` keywords, as in
`function* foo()` and `yield* iter`, rather than ~~`function *foo()`~~ or
~~`yield *iter`~~.

Parentheses around the left-hand side of a single-argument arrow function are
recommended but not required.

Do not put a space after the `...` in rest or spread syntax.

```ts
function myFunction(...elements: number[]) {}
myFunction(...array, ...iterable, ...generator());
```

### this [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#features-this)

Only use `this` in class constructors and methods, functions that have an
explicit `this` type declared (e.g. `function func(this: ThisType, ...)`), or in
arrow functions defined in a scope where `this` may be used.

Never use `this` to refer to the global object, the context of an `eval`, the
target of an event, or unnecessarily `call()`ed or `apply()`ed functions.

```ts
this.alert('Hello');
```

### Interfaces [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#interfaces)

### Primitive literals [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#primitive-literals)

#### String literals [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#string-literals)

##### Use single quotes

Ordinary string literals are delimited with single quotes (`'`), rather than
double quotes (`"`).

Tip: if a string contains a single quote character, consider using a template
string to avoid having to escape the quote.

##### No line continuations

Do not use _line continuations_ (that is, ending a line inside a string literal
with a backslash) in either ordinary or template string literals. Even though
ES5 allows this, it can lead to tricky errors if any trailing whitespace comes
after the slash, and is less obvious to readers.

Disallowed:

```ts
const LONG_STRING = 'This is a very very very very very very very long string. \
    It inadvertently contains long stretches of spaces due to how the \
    continued lines are indented.';
```

Instead, write

```ts
const LONG_STRING = 'This is a very very very very very very long string. ' +
    'It does not contain long stretches of spaces because it uses ' +
    'concatenated strings.';
const SINGLE_STRING =
    'http://it.is.also/acceptable_to_use_a_single_long_string_when_breaking_would_hinder_search_discoverability';
```

##### Template literals

Use template literals (delimited with `````) over complex string
concatenation, particularly if multiple string literals are involved. Template
literals may span multiple lines.

If a template literal spans multiple lines, it does not need to follow the
indentation of the enclosing block, though it may if the added whitespace does
not matter.

Example:

```ts
function arithmetic(a: number, b: number) {
  return `Here is a table of arithmetic operations:
${a} + ${b} = ${a + b}
${a} - ${b} = ${a - b}
${a} * ${b} = ${a * b}
${a} / ${b} = ${a / b}`;
}
```

#### Number literals [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#number-literals)

Numbers may be specified in decimal, hex, octal, or binary. Use exactly `0x`,
`0o`, and `0b` prefixes, with lowercase letters, for hex, octal, and binary,
respectively. Never include a leading zero unless it is immediately followed by
`x`, `o`, or `b`.

#### Type coercion [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#type-coercion)

TypeScript code _may_ use the `String()` and `Boolean()` (note: no `new`!)
functions, string template literals, or `!!` to coerce types.

```ts
const bool = Boolean(false);
const str = String(aNumber);
const bool2 = !!str;
const str2 = `result: ${bool2}`;
```

Values of enum types (including unions of enum types and other types) _must not_
be converted to booleans with `Boolean()` or `!!`, and must instead be compared
explicitly with comparison operators.

```ts
enum SupportLevel {
  NONE,
  BASIC,
  ADVANCED,
}

const level: SupportLevel = ...;
let enabled = Boolean(level);

const maybeLevel: SupportLevel|undefined = ...;
enabled = !!maybeLevel;
```

```ts
enum SupportLevel {
  NONE,
  BASIC,
  ADVANCED,
}

const level: SupportLevel = ...;
let enabled = level !== SupportLevel.NONE;

const maybeLevel: SupportLevel|undefined = ...;
enabled = level !== undefined && level !== SupportLevel.NONE;
```

Why?

For most purposes, it doesn't matter what number or string value an enum name is
mapped to at runtime, because values of enum types are referred to by name in
source code. Consequently, engineers are accustomed to not thinking about this,
and so situations where it _does_ matter are undesirable because they will be
surprising. Such is the case with conversion of enums to booleans; in
particular, by default, the first declared enum value is falsy (because it is 0)
while the others are truthy, which is likely to be unexpected. Readers of code
that uses an enum value may not even know whether it's the first declared value
or not.

Using string concatenation to cast to string is discouraged, as we check that
operands to the plus operator are of matching types.

Code _must_ use `Number()` to parse numeric values, and _must_ check its return
for `NaN` values explicitly, unless failing to parse is impossible from context.

Note: `Number('')`, `Number(' ')`, and `Number('\t')` would return `0` instead
of `NaN`. `Number('Infinity')` and `Number('-Infinity')` would return `Infinity`
and `-Infinity` respectively. Additionally, exponential notation such as
`Number('1e+309')` and `Number('-1e+309')` can overflow into `Infinity`. These
cases may require special handling.

```ts
const aNumber = Number('123');
if (!isFinite(aNumber)) throw new Error(...);
```

Code _must not_ use unary plus (`+`) to coerce strings to numbers. Parsing
numbers can fail, has surprising corner cases, and can be a code smell (parsing
at the wrong layer). A unary plus is too easy to miss in code reviews given
this.

```ts
const x = +y;
```

Code also _must not_ use `parseInt` or `parseFloat` to parse numbers, except for
non-base-10 strings (see below). Both of those functions ignore trailing
characters in the string, which can shadow error conditions (e.g. parsing `12
dwarves` as `12`).

```ts
const n = parseInt(someString, 10);  // Error prone,
const f = parseFloat(someString);    // regardless of passing a radix.
```

Code that requires parsing with a radix _must_ check that its input contains
only appropriate digits for that radix before calling into `parseInt`;

```ts
if (!/^[a-fA-F0-9]+$/.test(someString)) throw new Error(...);
// Needed to parse hexadecimal.
// tslint:disable-next-line:ban
const n = parseInt(someString, 16);  // Only allowed for radix != 10
```

Use `Number()` followed by `Math.floor` or `Math.trunc` (where available) to
parse integer numbers:

```ts
let f = Number(someString);
if (isNaN(f)) handleError();
f = Math.floor(f);
```

##### Implicit coercion

Do not use explicit boolean coercions in conditional clauses that have implicit
boolean coercion. Those are the conditions in an `if`, `for` and `while`
statements.

```ts
const foo: MyInterface|null = ...;
if (!!foo) {...}
while (!!foo) {...}
```

```ts
const foo: MyInterface|null = ...;
if (foo) {...}
while (foo) {...}
```

[As with explicit conversions](https://google.github.io/styleguide/tsguide.html#type-coercion), values of enum types (including
unions of enum types and other types) _must not_ be implicitly coerced to
booleans, and must instead be compared explicitly with comparison operators.

```ts
enum SupportLevel {
  NONE,
  BASIC,
  ADVANCED,
}

const level: SupportLevel = ...;
if (level) {...}

const maybeLevel: SupportLevel|undefined = ...;
if (level) {...}
```

```ts
enum SupportLevel {
  NONE,
  BASIC,
  ADVANCED,
}

const level: SupportLevel = ...;
if (level !== SupportLevel.NONE) {...}

const maybeLevel: SupportLevel|undefined = ...;
if (level !== undefined && level !== SupportLevel.NONE) {...}
```

Other types of values may be either implicitly coerced to booleans or compared
explicitly with comparison operators:

```ts
// Explicitly comparing > 0 is OK:
if (arr.length > 0) {...}
// so is relying on boolean coercion:
if (arr.length) {...}
```

### Control structures [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#control-structures)

#### Control flow statements and blocks [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#control-flow-statements-blocks)

Control flow statements (`if`, `else`, `for`, `do`, `while`, etc) always use
braced blocks for the containing code, even if the body contains only a single
statement. The first statement of a non-empty block must begin on its own line.

```ts
for (let i = 0; i < x; i++) {
  doSomethingWith(i);
}

if (x) {
  doSomethingWithALongMethodNameThatForcesANewLine(x);
}
```

```ts
if (x)
  doSomethingWithALongMethodNameThatForcesANewLine(x);

for (let i = 0; i < x; i++) doSomethingWith(i);
```

**Exception:**`if` statements fitting on one line _may_ elide the block.

```ts
if (x) x.doFoo();
```

##### Assignment in control statements

Prefer to avoid assignment of variables inside control statements. Assignment
can be easily mistaken for equality checks inside control statements.

```ts
if (x = someFunction()) {
  // Assignment easily mistaken with equality check
  // ...
}
```

```ts
x = someFunction();
if (x) {
  // ...
}
```

In cases where assignment inside the control statement is preferred, enclose the
assignment in additional parenthesis to indicate it is intentional.

```ts
while ((x = someFunction())) {
  // Double parenthesis shows assignment is intentional
  // ...
}
```

##### Iterating containers

Prefer `for (... of someArr)` to iterate over arrays. `Array.prototype.forEach` and vanilla `for`
loops are also allowed:

```ts
for (const x of someArr) {
  // x is a value of someArr.
}

for (let i = 0; i < someArr.length; i++) {
  // Explicitly count if the index is needed, otherwise use the for/of form.
  const x = someArr[i];
  // ...
}
for (const [i, x] of someArr.entries()) {
  // Alternative version of the above.
}
```

`for`-`in` loops may only be used on dict-style objects (see
[below](https://google.github.io/styleguide/tsguide.html#optimization-compatibility-for-property-access) for more info). Do not
use `for (... in ...)` to iterate over arrays as it will counterintuitively give
the array's indices (as strings!), not values:

```ts
for (const x in someArray) {
  // x is the index!
}
```

`Object.prototype.hasOwnProperty` should be used in `for`-`in` loops to exclude
unwanted prototype properties. Prefer `for`-`of` with `Object.keys`,
`Object.values`, or `Object.entries` over `for`-`in` when possible.

```ts
for (const key in obj) {
  if (!obj.hasOwnProperty(key)) continue;
  doWork(key, obj[key]);
}
for (const key of Object.keys(obj)) {
  doWork(key, obj[key]);
}
for (const value of Object.values(obj)) {
  doWorkValOnly(value);
}
for (const [key, value] of Object.entries(obj)) {
  doWork(key, value);
}
```

#### Grouping parentheses [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#grouping-parentheses)

Optional grouping parentheses are omitted only when the author and reviewer
agree that there is no reasonable chance that the code will be misinterpreted
without them, nor would they have made the code easier to read. It is _not_
reasonable to assume that every reader has the entire operator precedence table
memorized.

Do not use unnecessary parentheses around the entire expression following
`delete`, `typeof`, `void`, `return`, `throw`, `case`, `in`, `of`, or `yield`.

#### Exception handling [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#exception-handling)

Exceptions are an important part of the language and should be used whenever
exceptional cases occur.

Custom exceptions provide a great way to convey additional error information
from functions. They should be defined and used wherever the native `Error` type
is insufficient.

Prefer throwing exceptions over ad-hoc error-handling approaches (such as
passing an error container reference type, or returning an object with an error
property).

##### Instantiate errors using `new`

Always use `new Error()` when instantiating exceptions, instead of just calling
`Error()`. Both forms create a new `Error` instance, but using `new` is more
consistent with how other objects are instantiated.

```ts
throw new Error('Foo is not a valid bar.');
```

```ts
throw Error('Foo is not a valid bar.');
```

##### Only throw errors

JavaScript (and thus TypeScript) allow throwing or rejecting a Promise with
arbitrary values. However if the thrown or rejected value is not an `Error`, it
does not populate stack trace information, making debugging hard. This treatment
extends to `Promise` rejection values as `Promise.reject(obj)` is equivalent to
`throw obj;` in async functions.

```ts
// bad: does not get a stack trace.
throw 'oh noes!';
// For promises
new Promise((resolve, reject) => void reject('oh noes!'));
Promise.reject();
Promise.reject('oh noes!');
```

Instead, only throw (subclasses of) `Error`:

```ts
// Throw only Errors
throw new Error('oh noes!');
// ... or subtypes of Error.
class MyError extends Error {}
throw new MyError('my oh noes!');
// For promises
new Promise((resolve) => resolve()); // No reject is OK.
new Promise((resolve, reject) => void reject(new Error('oh noes!')));
Promise.reject(new Error('oh noes!'));
```

##### Catching and rethrowing

When catching errors, code _should_ assume that all thrown errors are instances
of `Error`.

```ts
function assertIsError(e: unknown): asserts e is Error {
  if (!(e instanceof Error)) throw new Error("e is not an Error");
}

try {
  doSomething();
} catch (e: unknown) {
  // All thrown errors must be Error subtypes. Do not handle
  // other possible values unless you know they are thrown.
  assertIsError(e);
  displayError(e.message);
  // or rethrow:
  throw e;
}
```

Exception handlers _must not_ defensively handle non-`Error` types unless the
called API is conclusively known to throw non-`Error`s in violation of the above
rule. In that case, a comment should be included to specifically identify where
the non-`Error`s originate.

```ts
try {
  badApiThrowingStrings();
} catch (e: unknown) {
  // Note: bad API throws strings instead of errors.
  if (typeof e === 'string') { ... }
}
```

Why?

Avoid
[overly defensive programming](https://en.wikipedia.org/wiki/Defensive_programming#Offensive_programming).
Repeating the same defenses against a problem that will not exist in most code
leads to boiler-plate code that is not useful.

##### Empty catch blocks

It is very rarely correct to do nothing in response to a caught exception. When
it truly is appropriate to take no action whatsoever in a catch block, the
reason this is justified is explained in a comment.

```ts
  try {
    return handleNumericResponse(response);
  } catch (e: unknown) {
    // Response is not numeric. Continue to handle as text.
  }
  return handleTextResponse(response);
```

Disallowed:

```ts
  try {
    shouldFail();
    fail('expected an error');
  } catch (expected: unknown) {
  }
```

Tip: Unlike in some other languages, patterns like the above simply don‚Äôt work
since this will catch the error thrown by `fail`. Use `assertThrows()` instead.

#### Switch statements [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#switch-statements)

All `switch` statements _must_ contain a `default` statement group, even if it
contains no code. The `default` statement group must be last.

```ts
switch (x) {
  case Y:
    doSomethingElse();
    break;
  default:
    // nothing to do.
}
```

Within a switch block, each statement group either terminates abruptly with a
`break`, a `return` statement, or by throwing an exception. Non-empty statement
groups (`case ...`) _must not_ fall through (enforced by the compiler):

```ts
switch (x) {
  case X:
    doSomething();
    // fall through - not allowed!
  case Y:
    // ...
}
```

Empty statement groups are allowed to fall through:

```ts
switch (x) {
  case X:
  case Y:
    doSomething();
    break;
  default: // nothing to do.
}
```

#### Equality checks [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#equality-checks)

Always use triple equals (`===`) and not equals (`!==`). The double equality
operators cause error prone type coercions that are hard to understand and
slower to implement for JavaScript Virtual Machines. See also the
[JavaScript equality table](https://dorey.github.io/JavaScript-Equality-Table/).

```ts
if (foo == 'bar' || baz != bam) {
  // Hard to understand behaviour due to type coercion.
}
```

```ts
if (foo === 'bar' || baz !== bam) {
  // All good here.
}
```

**Exception:** Comparisons to the literal `null` value _may_ use the `==` and
`!=` operators to cover both `null` and `undefined` values.

```ts
if (foo == null) {
  // Will trigger when foo is null or undefined.
}
```

#### Type and non-nullability assertions [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#type-and-non-nullability-assertions)

Type assertions (`x as SomeType`) and non-nullability assertions (`y!`) are
unsafe. Both only silence the TypeScript compiler, but do not insert any runtime
checks to match these assertions, so they can cause your program to crash at
runtime.

Because of this, you _should not_ use type and non-nullability assertions
without an obvious or explicit reason for doing so.

Instead of the following:

```ts
(x as Foo).foo();

y!.bar();
```

When you want to assert a type or non-nullability the best answer is to
explicitly write a runtime check that performs that check.

```ts
// assuming Foo is a class.
if (x instanceof Foo) {
  x.foo();
}

if (y) {
  y.bar();
}
```

Sometimes due to some local property of your code you can be sure that the
assertion form is safe. In those situations, you _should_ add clarification to
explain why you are ok with the unsafe behavior:

```ts
// x is a Foo, because ...
(x as Foo).foo();

// y cannot be null, because ...
y!.bar();
```

If the reasoning behind a type or non-nullability assertion is obvious, the
comments _may_ not be necessary. For example, generated proto code is always
nullable, but perhaps it is well-known in the context of the code that certain
fields are always provided by the backend. Use your judgement.

##### Type assertion syntax

Type assertions _must_ use the `as` syntax (as opposed to the angle brackets
syntax). This enforces parentheses around the assertion when accessing a member.

```ts
const x = (<Foo>z).length;
const y = <Foo>z.length;
```

```ts
// z must be Foo because ...
const x = (z as Foo).length;
```

##### Double assertions

From the
[TypeScript handbook](https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#type-assertions),
TypeScript only allows type assertions which convert to a _more specific_ or
_less specific_ version of a type. Adding a type assertion (`x as Foo`) which
does not meet this criteria will give the error: Conversion of type 'X' to type
'Y' may be a mistake because neither type sufficiently overlaps with the other.

If you are sure an assertion is safe, you can perform a _double assertion_. This
involves casting through `unknown` since it is less specific than all types.

```ts
// x is a Foo here, because...
(x as unknown as Foo).fooMethod();
```

Use `unknown` (instead of `any` or `{}`) as the intermediate type.

##### Type assertions and object literals

Use type annotations (`: Foo`) instead of type assertions (`as Foo`) to specify
the type of an object literal. This allows detecting refactoring bugs when the
fields of an interface change over time.

```ts
interface Foo {
  bar: number;
  baz?: string;  // was "bam", but later renamed to "baz".
}

const foo = {
  bar: 123,
  bam: 'abc',  // no error!
} as Foo;

function func() {
  return {
    bar: 123,
    bam: 'abc',  // no error!
  } as Foo;
}
```

```ts
interface Foo {
  bar: number;
  baz?: string;
}

const foo: Foo = {
  bar: 123,
  bam: 'abc',  // complains about "bam" not being defined on Foo.
};

function func(): Foo {
  return {
    bar: 123,
    bam: 'abc',   // complains about "bam" not being defined on Foo.
  };
}
```

#### Keep try blocks focused [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#keep-try-blocks-focused)

Limit the amount of code inside a try block, if this can be done without hurting
readability.

```ts
try {
  const result = methodThatMayThrow();
  use(result);
} catch (error: unknown) {
  // ...
}
```

```ts
let result;
try {
  result = methodThatMayThrow();
} catch (error: unknown) {
  // ...
}
use(result);
```

Moving the non-throwable lines out of the try/catch block helps the reader learn
which method throws exceptions. Some inline calls that do not throw exceptions
could stay inside because they might not be worth the extra complication of a
temporary variable.

**Exception:** There may be performance issues if try blocks are inside a loop.
Widening try blocks to cover a whole loop is ok.

### Decorators [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#decorators)

Decorators are syntax with an `@` prefix, like `@MyDecorator`.

Do not define new decorators. Only use the decorators defined by
frameworks:

- Angular (e.g. `@Component`, `@NgModule`, etc.)
- Polymer (e.g. `@property`)

Why?

We generally want to avoid decorators, because they were an experimental feature
that have since diverged from the TC39 proposal and have known bugs that won't
be fixed.

When using decorators, the decorator _must_ immediately precede the symbol it
decorates, with no empty lines between:

```ts
/** JSDoc comments go before decorators */
@Component({...})  // Note: no empty line after the decorator.
class MyComp {
  @Input() myField: string;  // Decorators on fields may be on the same line...

  @Input()
  myOtherField: string;  // ... or wrap.
}
```

### Disallowed features [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#disallowed-features)

#### Wrapper objects for primitive types [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#primitive-types-wrapper-classes)

TypeScript code _must not_ instantiate the wrapper classes for the primitive
types `String`, `Boolean`, and `Number`. Wrapper classes have surprising
behavior, such as `new Boolean(false)` evaluating to `true`.

```ts
const s = new String('hello');
const b = new Boolean(false);
const n = new Number(5);
```

The wrappers may be called as functions for coercing (which is preferred over
using `+` or concatenating the empty string) or creating symbols. See
[type coercion](https://google.github.io/styleguide/tsguide.html#type-coercion) for more information.

#### Automatic Semicolon Insertion [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#automatic-semicolon-insertion)

Do not rely on Automatic Semicolon Insertion (ASI). Explicitly end all
statements using a semicolon. This prevents bugs due to incorrect semicolon
insertions and ensures compatibility with tools with limited ASI support (e.g.
clang-format).

#### Const enums [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#enums)

Code _must not_ use `const enum`; use plain `enum` instead.

Why?

TypeScript enums already cannot be mutated; `const enum` is a separate language
feature related to optimization that makes the enum invisible to
JavaScript users of the module.

#### Debugger statements [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#debugger-statements)

Debugger statements _must not_ be included in production code.

```ts
function debugMe() {
  debugger;
}
```

#### `with` [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#diallowed-features-with)

Do not use the `with` keyword. It makes your code harder to understand and
[has been banned in strict mode since ES5](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/with).

#### Dynamic code evaluation [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#dynamic-code-evaluation)

Do not use `eval` or the `Function(...string)` constructor (except for code
loaders). These features are potentially dangerous and simply do not work in
environments using strict
[Content Security Policies](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP).

#### Non-standard features [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#non-standard-features)

Do not use non-standard ECMAScript or Web Platform features.

This includes:

- Old features that have been marked deprecated or removed entirely from
ECMAScript / the Web Platform (see
[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Deprecated_and_obsolete_features))
- New ECMAScript features that are not yet standardized
  - Avoid using features that are in current TC39 working draft or currently
    in the [proposal process](https://tc39.es/process-document/)
  - Use only ECMAScript features defined in the current ECMA-262
    specification
- Proposed but not-yet-complete web standards:
  - WHATWG proposals that have not completed the
    [proposal process](https://whatwg.org/faq#adding-new-features).
- Non-standard language ‚Äúextensions‚Äù (such as those provided by some external
transpilers)

Projects targeting specific JavaScript runtimes, such as latest-Chrome-only,
Chrome extensions, Node.JS, Electron, can obviously use those APIs. Use caution
when considering an API surface that is proprietary and only implemented in some
browsers; consider whether there is a common library that can abstract this API
surface away for you.

#### Modifying builtin objects [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#modifying-builtin-objects)

Never modify builtin types, either by adding methods to their constructors or to
their prototypes. Avoid depending on libraries that do
this.

Do not add symbols to the global object unless absolutely necessary (e.g.
required by a third-party API).

## Naming [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#naming)

### Identifiers [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#identifiers)

Identifiers _must_ use only ASCII letters, digits, underscores (for constants
and structured test method names), and (rarely) the '$' sign.

#### Naming style [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#naming-style)

TypeScript expresses information in types, so names _should not_ be decorated
with information that is included in the type. (See also
[Testing Blog](https://testing.googleblog.com/2017/10/code-health-identifiernamingpostforworl.html)
for more about what
not to include.)

Some concrete examples of this rule:

- Do not use trailing or leading underscores for private properties or
methods.
- Do not use the `opt_` prefix for optional parameters.

  - For accessors, see [accessor rules](https://google.github.io/styleguide/tsguide.html#getters-and-setters-accessors)
    below.
- Do not mark interfaces specially ( ~~`IMyInterface`~~ or
~~`MyFooInterface`~~) unless it's idiomatic in its
environment. When
introducing an interface for a class, give it a name that expresses why the
interface exists in the first place (e.g. `class TodoItem` and `interface
TodoItemStorage` if the interface expresses the format used for
storage/serialization in JSON).
- Suffixing `Observable`s with `$` is a common external convention and can
help resolve confusion regarding observable values vs concrete values.
Judgement on whether this is a useful convention is left up to individual
teams, but _should_ be consistent within projects.

#### Descriptive names [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#descriptive-names)

Names _must_ be descriptive and clear to a new reader. Do not use abbreviations
that are ambiguous or unfamiliar to readers outside your project, and do not
abbreviate by deleting letters within a word.

- **Exception:** Variables that are in scope for 10 lines or fewer, including
arguments that are _not_ part of an exported API, _may_ use short (e.g.
single letter) variable names.

```ts
// Good identifiers:
errorCount          // No abbreviation.
dnsConnectionIndex  // Most people know what "DNS" stands for.
referrerUrl         // Ditto for "URL".
customerId          // "Id" is both ubiquitous and unlikely to be misunderstood.
```

```ts
// Disallowed identifiers:
n                   // Meaningless.
nErr                // Ambiguous abbreviation.
nCompConns          // Ambiguous abbreviation.
wgcConnections      // Only your group knows what this stands for.
pcReader            // Lots of things can be abbreviated "pc".
cstmrId             // Deletes internal letters.
kSecondsPerDay      // Do not use Hungarian notation.
customerID          // Incorrect camelcase of "ID".
```

#### Camel case [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#camel-case)

Treat abbreviations like acronyms in names as whole words, i.e. use
`loadHttpUrl`, not ~~`loadHTTPURL`~~, unless required by a platform name (e.g.
`XMLHttpRequest`).

#### Dollar sign [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#identifiers-dollar-sign)

Identifiers _should not_ generally use `$`, except when required by naming
conventions for third party frameworks. [See above](https://google.github.io/styleguide/tsguide.html#naming-style) for more on
using `$` with `Observable` values.

### Rules by identifier type [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#naming-rules-by-identifier-type)

Most identifier names should follow the casing in the table below, based on the
identifier's type.

| Style | Category |
| --- | --- |
| `UpperCamelCase` | class / interface / type / enum / decorator / type<br>parameters / component functions in TSX / JSXElement type<br>parameter |
| `lowerCamelCase` | variable / parameter / function / method / property /<br>module alias |
| `CONSTANT_CASE` | global constant values, including enum values. See<br>[Constants](https://google.github.io/styleguide/tsguide.html#identifiers-constants) below. |
| `#ident` | private identifiers are never used. |

#### Type parameters [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#identifiers-type-parameters)

Type parameters, like in `Array<T>`, _may_ use a single upper case character
(`T`) or `UpperCamelCase`.

#### Test names [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#identifiers-test-names)

Test method names inxUnit-style test frameworks _may_ be structured with `_` separators, e.g.
`testX_whenY_doesZ()`.

#### `_` prefix/suffix [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#identifiers-underscore-prefix-suffix)

Identifiers must not use `_` as a prefix or suffix.

This also means that `_` _must not_ be used as an identifier by itself (e.g. to
indicate a parameter is unused).

> Tip: If you only need some of the elements from an array (or TypeScript
> tuple), you can insert extra commas in a destructuring statement to ignore
> in-between elements:
>
> ```ts
> const [a, , b] = [1, 5, 10];  // a <- 1, b <- 10
> ```

#### Imports [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#identifiers-imports)

Module namespace imports are `lowerCamelCase` while files are `snake_case`,
which means that imports correctly will not match in casing style, such as

```ts
import * as fooBar from './foo_bar';
```

Some libraries might commonly use a namespace import prefix that violates this
naming scheme, but overbearingly common open source use makes the violating
style more readable. The only libraries that currently fall under this exception
are:

- [jquery](https://jquery.com/), using the `$` prefix
- [threejs](https://threejs.org/), using the `THREE` prefix

#### Constants [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#identifiers-constants)

**Immutable**: `CONSTANT_CASE` indicates that a value is _intended_ to not be
changed, and _may_ be used for values that can technically be modified (i.e.
values that are not deeply frozen) to indicate to users that they must not be
modified.

```ts
const UNIT_SUFFIXES = {
  'milliseconds': 'ms',
  'seconds': 's',
};
// Even though per the rules of JavaScript UNIT_SUFFIXES is
// mutable, the uppercase shows users to not modify it.
```

A constant can also be a `static readonly` property of a class.

```ts
class Foo {
  private static readonly MY_SPECIAL_NUMBER = 5;

  bar() {
    return 2 * Foo.MY_SPECIAL_NUMBER;
  }
}
```

**Global**: Only symbols declared on the module level, static fields of module
level classes, and values of module level enums, _may_ use `CONST_CASE`. If a
value can be instantiated more than once over the lifetime of the program (e.g.
a local variable declared within a function, or a static field on a class nested
in a function) then it _must_ use `lowerCamelCase`.

If a value is an arrow function that implements an interface, then it _may_ be
declared `lowerCamelCase`.

#### Aliases [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#aliases)

When creating a local-scope alias of an existing symbol, use the format of the
existing identifier. The local alias _must_ match the existing naming and format
of the source. For variables use `const` for your local aliases, and for class
fields use the `readonly` attribute.

> Note: If you're creating an alias just to expose it to a template in your
> framework of choice, remember to also apply the proper
> [access modifiers](https://google.github.io/styleguide/tsguide.html#properties-used-outside-of-class-lexical-scope).

```ts
const {BrewStateEnum} = SomeType;
const CAPACITY = 5;

class Teapot {
  readonly BrewStateEnum = BrewStateEnum;
  readonly CAPACITY = CAPACITY;
}
```

## Type system [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#type-system)

### Type inference [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#type-inference)

Code _may_ rely on type inference as implemented by the TypeScript compiler for
all type expressions (variables, fields, return types, etc).

```ts
const x = 15;  // Type inferred.
```

Leave out type annotations for trivially inferred types: variables or parameters
initialized to a `string`, `number`, `boolean`, `RegExp` literal or `new`
expression.

```ts
const x: boolean = true;  // Bad: 'boolean' here does not aid readability
```

```ts
// Bad: 'Set' is trivially inferred from the initialization
const x: Set<string> = new Set();
```

Explicitly specifying types may be required to prevent generic type parameters
from being inferred as `unknown`. For example, initializing generic types with
no values (e.g. empty arrays, objects, `Map`s, or `Set`s).

```ts
const x = new Set<string>();
```

For more complex expressions, type annotations can help with readability of the
program:

```ts
// Hard to reason about the type of 'value' without an annotation.
const value = await rpc.getSomeValue().transform();
```

```ts
// Can tell the type of 'value' at a glance.
const value: string[] = await rpc.getSomeValue().transform();
```

Whether an annotation is required is decided by the code reviewer.

#### Return types [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#return-types)

Whether to include return type annotations for functions and methods is up to
the code author. Reviewers _may_ ask for annotations to clarify complex return
types that are hard to understand. Projects _may_ have a local policy to always
require return types, but this is not a general TypeScript style requirement.

There are two benefits to explicitly typing out the implicit return values of
functions and methods:

- More precise documentation to benefit readers of the code.
- Surface potential type errors faster in the future if there are code changes
that change the return type of the function.

### Undefined and null [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#undefined-and-null)

TypeScript supports `undefined` and `null` types. Nullable types can be
constructed as a union type (`string|null`); similarly with `undefined`. There
is no special syntax for unions of `undefined` and `null`.

TypeScript code can use either `undefined` or `null` to denote absence of a
value, there is no general guidance to prefer one over the other. Many
JavaScript APIs use `undefined` (e.g. `Map.get`), while many DOM and Google APIs
use `null` (e.g. `Element.getAttribute`), so the appropriate absent value
depends on the context.

#### Nullable/undefined type aliases [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#nullableundefined-type-aliases)

Type aliases _must not_ include `|null` or `|undefined` in a union type.
Nullable aliases typically indicate that null values are being passed around
through too many layers of an application, and this clouds the source of the
original issue that resulted in `null`. They also make it unclear when specific
values on a class or interface might be absent.

Instead, code _must_ only add `|null` or `|undefined` when the alias is actually
used. Code _should_ deal with null values close to where they arise, using the
above techniques.

```ts
// Bad
type CoffeeResponse = Latte|Americano|undefined;

class CoffeeService {
  getLatte(): CoffeeResponse { ... };
}
```

```ts
// Better
type CoffeeResponse = Latte|Americano;

class CoffeeService {
  getLatte(): CoffeeResponse|undefined { ... };
}
```

#### Prefer optional over `|undefined` [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#prefer-optional-over-undefined)

In addition, TypeScript supports a special construct for optional parameters and
fields, using `?`:

```ts
interface CoffeeOrder {
  sugarCubes: number;
  milk?: Whole|LowFat|HalfHalf;
}

function pourCoffee(volume?: Milliliter) { ... }
```

Optional parameters implicitly include `|undefined` in their type. However, they
are different in that they can be left out when constructing a value or calling
a method. For example, `{sugarCubes: 1}` is a valid `CoffeeOrder` because `milk`
is optional.

Use optional fields (on interfaces or classes) and parameters rather than a
`|undefined` type.

For classes preferably avoid this pattern altogether and initialize as many
fields as possible.

```ts
class MyClass {
  field = '';
}
```

### Use structural types [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#use-structural-types)

TypeScript's type system is structural, not nominal. That is, a value matches a
type if it has at least all the properties the type requires and the properties'
types match, recursively.

When providing a structural-based implementation, explicitly include the type at
the declaration of the symbol (this allows more precise type checking and error
reporting).

```ts
const foo: Foo = {
  a: 123,
  b: 'abc',
}
```

```ts
const badFoo = {
  a: 123,
  b: 'abc',
}
```

Use interfaces to define structural types, not classes

```ts
interface Foo {
  a: number;
  b: string;
}

const foo: Foo = {
  a: 123,
  b: 'abc',
}
```

```ts
class Foo {
  readonly a: number;
  readonly b: number;
}

const foo: Foo = {
  a: 123,
  b: 'abc',
}
```

Why?

The badFoo object above relies on type inference. Additional fields could be
added to badFoo and the type is inferred based on the object itself.

When passing a badFoo to a function that takes a Foo, the error will be at
the function call site, rather than at the object declaration site. This is also
useful when changing the surface of an interface across broad codebases.

```ts
interface Animal {
  sound: string;
  name: string;
}

function makeSound(animal: Animal) {}

/**
 * 'cat' has an inferred type of '{sound: string}'
 */
const cat = {
  sound: 'meow',
};

/**
 * 'cat' does not meet the type contract required for the function, so the
 * TypeScript compiler errors here, which may be very far from where 'cat' is
 * defined.
 */
makeSound(cat);

/**
 * Horse has a structural type and the type error shows here rather than the
 * function call.  'horse' does not meet the type contract of 'Animal'.
 */
const horse: Animal = {
  sound: 'niegh',
};

const dog: Animal = {
  sound: 'bark',
  name: 'MrPickles',
};

makeSound(dog);
makeSound(horse);
```

### Prefer interfaces over type literal aliases [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#prefer-interfaces)

TypeScript supports
[type aliases](https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#type-aliases)
for naming a type expression. This can be used to name primitives, unions,
tuples, and any other types.

However, when declaring types for objects, use interfaces instead of a type
alias for the object literal expression.

```ts
interface User {
  firstName: string;
  lastName: string;
}
```

```ts
type User = {
  firstName: string,
  lastName: string,
}
```

Why?

These forms are nearly equivalent, so under the principle of just choosing one
out of two forms to prevent variation, we should choose one. Additionally, there
are also
[interesting technical reasons to prefer interface](https://ncjamieson.com/prefer-interfaces/).
That page quotes the TypeScript team lead: Honestly, my take is that it should
really just be interfaces for anything that they can model. There is no benefit
to type aliases when there are so many issues around display/perf.

### `Array<T>` Type [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#arrayt-type)

For simple types (containing just alphanumeric characters and dot), use the
syntax sugar for arrays, `T[]` or `readonly T[]`, rather than the longer form
`Array<T>` or `ReadonlyArray<T>`.

For multi-dimensional non-`readonly` arrays of simple types, use the syntax
sugar form (`T[][]`, `T[][][]`, and so on) rather than the longer form.

For anything more complex, use the longer form `Array<T>`.

These rules apply at each level of nesting, i.e. a simple `T[]` nested in a more
complex type would still be spelled as `T[]`, using the syntax sugar.

```ts
let a: string[];
let b: readonly string[];
let c: ns.MyObj[];
let d: string[][];
let e: Array<{n: number, s: string}>;
let f: Array<string|number>;
let g: ReadonlyArray<string|number>;
let h: InjectionToken<string[]>;  // Use syntax sugar for nested types.
let i: ReadonlyArray<string[]>;
let j: Array<readonly string[]>;
```

```ts
let a: Array<string>;  // The syntax sugar is shorter.
let b: ReadonlyArray<string>;
let c: Array<ns.MyObj>;
let d: Array<string[]>;
let e: {n: number, s: string}[];  // The braces make it harder to read.
let f: (string|number)[];         // Likewise with parens.
let g: readonly (string | number)[];
let h: InjectionToken<Array<string>>;
let i: readonly string[][];
let j: (readonly string[])[];
```

### Indexable types / index signatures (`{[key: string]: T}`) [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#indexable-key-string-type)

In JavaScript, it's common to use an object as an associative array (aka map,
hash, or dict). Such objects can be typed using an
[index signature](https://www.typescriptlang.org/docs/handbook/2/objects.html#index-signatures)
(`[k: string]: T`) in TypeScript:

```ts
const fileSizes: {[fileName: string]: number} = {};
fileSizes['readme.txt'] = 541;
```

In TypeScript, provide a meaningful label for the key. (The label only exists
for documentation; it's unused otherwise.)

```ts
const users: {[key: string]: number} = ...;
```

```ts
const users: {[userName: string]: number} = ...;
```

> Rather than using one of these, consider using the ES6 `Map` and `Set` types
> instead. JavaScript objects have
> [surprising undesirable behaviors](http://2ality.com/2012/01/objects-as-maps.html)
> and the ES6 types more explicitly convey your intent. Also, `Map`s can be
> keyed by‚Äîand `Set`s can contain‚Äîtypes other than `string`.

TypeScript's builtin `Record<Keys, ValueType>` type allows constructing types
with a defined set of keys. This is distinct from associative arrays in that the
keys are statically known. See advice on that
[below](https://google.github.io/styleguide/tsguide.html#mapped-conditional-types).

### Mapped and conditional types [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#mapped-conditional-types)

TypeScript's
[mapped types](https://www.typescriptlang.org/docs/handbook/2/mapped-types.html)
and
[conditional types](https://www.typescriptlang.org/docs/handbook/2/conditional-types.html)
allow specifying new types based on other types. TypeScript's standard library
includes several type operators based on these (`Record`, `Partial`, `Readonly`
etc).

These type system features allow succinctly specifying types and constructing
powerful yet type safe abstractions. They come with a number of drawbacks
though:

- Compared to explicitly specifying properties and type relations (e.g. using
interfaces and extension, see below for an example), type operators require
the reader to mentally evaluate the type expression. This can make programs
substantially harder to read, in particular combined with type inference and
expressions crossing file boundaries.
- Mapped & conditional types' evaluation model, in particular when combined
with type inference, is underspecified, not always well understood, and
often subject to change in TypeScript compiler versions. Code can
accidentally compile or seem to give the right results. This increases
future support cost of code using type operators.
- Mapped & conditional types are most powerful when deriving types from
complex and/or inferred types. On the flip side, this is also when they are
most prone to create hard to understand and maintain programs.
- Some language tooling does not work well with these type system features.
E.g. your IDE's find references (and thus rename property refactoring) will
not find properties in a `Pick<T, Keys>` type, and Code Search won't
hyperlink them.

The style recommendation is:

- Always use the simplest type construct that can possibly express your code.
- A little bit of repetition or verbosity is often much cheaper than the long
term cost of complex type expressions.
- Mapped & conditional types may be used, subject to these considerations.

For example, TypeScript's builtin `Pick<T, Keys>` type allows creating a new
type by subsetting another type `T`, but simple interface extension can often be
easier to understand.

```ts
interface User {
  shoeSize: number;
  favoriteIcecream: string;
  favoriteChocolate: string;
}

// FoodPreferences has favoriteIcecream and favoriteChocolate, but not shoeSize.
type FoodPreferences = Pick<User, 'favoriteIcecream'|'favoriteChocolate'>;
```

This is equivalent to spelling out the properties on `FoodPreferences`:

```ts
interface FoodPreferences {
  favoriteIcecream: string;
  favoriteChocolate: string;
}
```

To reduce duplication, `User` could extend `FoodPreferences`, or (possibly
better) nest a field for food preferences:

```ts
interface FoodPreferences { /* as above */ }
interface User extends FoodPreferences {
  shoeSize: number;
  // also includes the preferences.
}
```

Using interfaces here makes the grouping of properties explicit, improves IDE
support, allows better optimization, and arguably makes the code easier to
understand.

### `any` Type [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#any)

TypeScript's `any` type is a super and subtype of all other types, and allows
dereferencing all properties. As such, `any` is dangerous - it can mask severe
programming errors, and its use undermines the value of having static types in
the first place.

**Consider _not_ to use `any`.** In circumstances where you want to use `any`,
consider one of:

- [Provide a more specific type](https://google.github.io/styleguide/tsguide.html#any-specific)
- [Use `unknown`](https://google.github.io/styleguide/tsguide.html#any-unknown)
- [Suppress the lint warning and document why](https://google.github.io/styleguide/tsguide.html#any-suppress)

#### Providing a more specific type [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#any-specific)

Use interfaces , an
inline object type, or a type alias:

```ts
// Use declared interfaces to represent server-side JSON.
declare interface MyUserJson {
  name: string;
  email: string;
}

// Use type aliases for types that are repetitive to write.
type MyType = number|string;

// Or use inline object types for complex returns.
function getTwoThings(): {something: number, other: string} {
  // ...
  return {something, other};
}

// Use a generic type, where otherwise a library would say `any` to represent
// they don't care what type the user is operating on (but note "Return type
// only generics" below).
function nicestElement<T>(items: T[]): T {
  // Find the nicest element in items.
  // Code can also put constraints on T, e.g. <T extends HTMLElement>.
}
```

#### Using `unknown` over `any` [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#any-unknown)

The `any` type allows assignment into any other type and dereferencing any
property off it. Often this behaviour is not necessary or desirable, and code
just needs to express that a type is unknown. Use the built-in type `unknown` in
that situation ‚Äî it expresses the concept and is much safer as it does not allow
dereferencing arbitrary properties.

```ts
// Can assign any value (including null or undefined) into this but cannot
// use it without narrowing the type or casting.
const val: unknown = value;
```

```ts
const danger: any = value /* result of an arbitrary expression */;
danger.whoops();  // This access is completely unchecked!
```

To safely use `unknown` values, narrow the type using a
[type guard](https://www.typescriptlang.org/docs/handbook/advanced-types.html#type-guards-and-differentiating-types)

#### Suppressing `any` lint warnings [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#any-suppress)

Sometimes using `any` is legitimate, for example in tests to construct a mock
object. In such cases, add a comment that suppresses the lint warning, and
document why it is legitimate.

```ts
// This test only needs a partial implementation of BookService, and if
// we overlooked something the test will fail in an obvious way.
// This is an intentionally unsafe partial mock
// tslint:disable-next-line:no-any
const mockBookService = ({get() { return mockBook; }} as any) as BookService;
// Shopping cart is not used in this test
// tslint:disable-next-line:no-any
const component = new MyComponent(mockBookService, /* unused ShoppingCart */ null as any);
```

### `{}` Type [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#empty-interface-type)

The `{}` type, also known as an _empty interface_ type, represents a interface
with no properties. An empty interface type has no specified properties and
therefore any non-nullish value is assignable to it.

```ts
let player: {};

player = {
  health: 50,
}; // Allowed.

console.log(player.health) // Property 'health' does not exist on type '{}'.
```

```ts
function takeAnything(obj:{}) {

}

takeAnything({});
takeAnything({ a: 1, b: 2 });
```

Google3 code **should not** use `{}` for most use cases. `{}` represents any
non-nullish primitive or object type, which is rarely appropriate. Prefer one of
the following more-descriptive types:

- `unknown` can hold any value, including `null` or `undefined`, and is
generally more appropriate for opaque values.
- `Record<string, T>` is better for dictionary-like objects, and provides
better type safety by being explicit about the type `T` of contained values
(which may itself be `unknown`).
- `object` excludes primitives as well, leaving only non-nullish functions and
objects, but without any other assumptions about what properties may be
available.

### Tuple types [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#tuple-types)

If you are tempted to create a Pair type, instead use a tuple type:

```ts
interface Pair {
  first: string;
  second: string;
}
function splitInHalf(input: string): Pair {
  ...
  return {first: x, second: y};
}
```

```ts
function splitInHalf(input: string): [string, string] {
  ...
  return [x, y];
}

// Use it like:
const [leftHalf, rightHalf] = splitInHalf('my string');
```

However, often it's clearer to provide meaningful names for the properties.

If declaring an `interface` is too heavyweight, you can use an inline object
literal type:

```ts
function splitHostPort(address: string): {host: string, port: number} {
  ...
}

// Use it like:
const address = splitHostPort(userAddress);
use(address.port);

// You can also get tuple-like behavior using destructuring:
const {host, port} = splitHostPort(userAddress);
```

### Wrapper types [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#wrapper-types)

There are a few types related to JavaScript primitives that _should not_ ever be
used:

- `String`, `Boolean`, and `Number` have slightly different meaning from the
corresponding primitive types `string`, `boolean`, and `number`. Always use
the lowercase version.
- `Object` has similarities to both `{}` and `object`, but is slightly looser.
Use `{}` for a type that include everything except `null` and `undefined`,
or lowercase `object` to further exclude the other primitive types (the
three mentioned above, plus `symbol` and `bigint`).

Further, never invoke the wrapper types as constructors (with `new`).

### Return type only generics [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#return-type-only-generics)

Avoid creating APIs that have return type only generics. When working with
existing APIs that have return type only generics always explicitly specify the
generics.

## Toolchain requirements [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#toolchain-requirements)

Google style requires using a number of tools in specific ways, outlined here.

### TypeScript compiler [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#typescript-compiler)

All TypeScript files must pass type checking using the standard
tool chain.

#### @ts-ignore [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#ts-ignore)

Do not use `@ts-ignore` nor the variants `@ts-expect-error` or `@ts-nocheck`.

Why?

They superficially seem to be an easy way to fix a compiler error, but in
practice, a specific compiler error is often caused by a larger problem that can
be fixed more directly.

For example, if you are using `@ts-ignore` to suppress a type error, then it's
hard to predict what types the surrounding code will end up seeing. For many
type errors, the advice in [how to best use `any`](https://google.github.io/styleguide/tsguide.html#any) is useful.

You may use `@ts-expect-error` in unit tests, though you generally _should not_.
`@ts-expect-error` suppresses all errors. It's easy to accidentally over-match
and suppress more serious errors. Consider one of:

- When testing APIs that need to deal with unchecked values at runtime, add
casts to the expected type or to `any` and add an explanatory comment. This
limits error suppression to a single expression.
- Suppress the lint warning and document why, similar to
[suppressing `any` lint warnings](https://google.github.io/styleguide/tsguide.html#any-suppress).

### Conformance [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#conformance)

Google TypeScript includes several _conformance frameworks_,

[tsetse](https://tsetse.info/) and
[tsec](https://github.com/google/tsec).

These rules are commonly used to enforce critical restrictions (such as defining
globals, which could break the codebase) and security patterns (such as using
`eval` or assigning to `innerHTML`), or more loosely to improve code quality.

Google-style TypeScript must abide by any applicable global or framework-local
conformance rules.

## Comments and documentation [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#comments-documentation)

#### JSDoc versus comments [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#jsdoc-vs-comments)

There are two types of comments, JSDoc (`/** ... */`) and non-JSDoc ordinary
comments (`// ...` or `/* ... */`).

- Use `/** JSDoc */` comments for documentation, i.e. comments a user of the
code should read.
- Use `// line comments` for implementation comments, i.e. comments that only
concern the implementation of the code itself.

JSDoc comments are understood by tools (such as editors and documentation
generators), while ordinary comments are only for other humans.

#### Multi-line comments [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#multi-line-comments)

Multi-line comments are indented at the same level as the surrounding code. They
_must_ use multiple single-line comments (`//`-style), not block comment style
(`/* */`).

```ts
// This is
// fine
```

```ts
/*
 * This should
 * use multiple
 * single-line comments
 */

/* This should use // */
```

Comments are not enclosed in boxes drawn with asterisks or other characters.

### JSDoc general form [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#jsdoc-general-form)

The basic formatting of JSDoc comments is as seen in this example:

```ts
/**
 * Multiple lines of JSDoc text are written here,
 * wrapped normally.
 * @param arg A number to do something to.
 */
function doSomething(arg: number) { ‚Ä¶ }
```

or in this single-line example:

```ts
/** This short jsdoc describes the function. */
function doSomething(arg: number) { ‚Ä¶ }
```

If a single-line comment overflows into multiple lines, it _must_ use the
multi-line style with `/**` and `*/` on their own lines.

Many tools extract metadata from JSDoc comments to perform code validation and
optimization. As such, these comments _must_ be well-formed.

### Markdown [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#jsdoc-markdown)

JSDoc is written in Markdown, though it _may_ include HTML when necessary.

This means that tooling parsing JSDoc will ignore plain text formatting, so if
you did this:

```ts
/**
 * Computes weight based on three factors:
 *   items sent
 *   items received
 *   last timestamp
 */
```

it will be rendered like this:

```
Computes weight based on three factors: items sent items received last timestamp
```

Instead, write a Markdown list:

```ts
/**
 * Computes weight based on three factors:
 *
 * - items sent
 * - items received
 * - last timestamp
 */
```

### JSDoc tags [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#jsdoc-tags)

Google style allows a subset of JSDoc tags. Most tags must occupy their own line, with the tag at the beginning
of the line.

```ts
/**
 * The "param" tag must occupy its own line and may not be combined.
 * @param left A description of the left param.
 * @param right A description of the right param.
 */
function add(left: number, right: number) { ... }
```

```ts
/**
 * The "param" tag must occupy its own line and may not be combined.
 * @param left @param right
 */
function add(left: number, right: number) { ... }
```

### Line wrapping [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#jsdoc-line-wrapping)

Line-wrapped block tags are indented four spaces. Wrapped description text _may_
be lined up with the description on previous lines, but this horizontal
alignment is discouraged.

```ts
/**
 * Illustrates line wrapping for long param/return descriptions.
 * @param foo This is a param with a particularly long description that just
 *     doesn't fit on one line.
 * @return This returns something that has a lengthy description too long to fit
 *     in one line.
 */
exports.method = function(foo) {
  return 5;
};
```

Do not indent when wrapping a `@desc` or `@fileoverview` description.

### Document all top-level exports of modules [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#document-all-top-level-exports-of-modules)

Use `/** JSDoc */` comments to communicate information to the users of your
code. Avoid merely restating the property or parameter name. You _should_ also
document all properties and methods (exported/public or not) whose purpose is
not immediately obvious from their name, as judged by your reviewer.

**Exception:** Symbols that are only exported to be consumed by tooling, such as
@NgModule classes, do not require comments.

### Class comments [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#jsdoc-class-comments)

JSDoc comments for classes should provide the reader with enough information to
know how and when to use the class, as well as any additional considerations
necessary to correctly use the class. Textual descriptions may be omitted on the
constructor.

### Method and function comments [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#method-and-function-comments)

Method, parameter, and return descriptions may be omitted if they are obvious
from the rest of the method‚Äôs JSDoc or from the method name and type signature.

Method descriptions begin with a verb phrase that describes what the method
does. This phrase is not an imperative sentence, but instead is written in the
third person, as if there is an implied This method ... before it.

### Parameter property comments [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#parameter-property-comments)

A
[parameter property](https://www.typescriptlang.org/docs/handbook/2/classes.html#parameter-properties)
is a constructor parameter that is prefixed by one of the modifiers `private`,
`protected`, `public`, or `readonly`. A parameter property declares both a
parameter and an instance property, and implicitly assigns into it. For example,
`constructor(private readonly foo: Foo)`, declares that the constructor takes a
parameter `foo`, but also declares a private readonly property `foo`, and
assigns the parameter into that property before executing the remainder of the
constructor.

To document these fields, use JSDoc's `@param` annotation. Editors display the
description on constructor calls and property accesses.

```ts
/** This class demonstrates how parameter properties are documented. */
class ParamProps {
  /**
   * @param percolator The percolator used for brewing.
   * @param beans The beans to brew.
   */
  constructor(
    private readonly percolator: Percolator,
    private readonly beans: CoffeeBean[]) {}
}
```

```ts
/** This class demonstrates how ordinary fields are documented. */
class OrdinaryClass {
  /** The bean that will be used in the next call to brew(). */
  nextBean: CoffeeBean;

  constructor(initialBean: CoffeeBean) {
    this.nextBean = initialBean;
  }
}
```

### JSDoc type annotations [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#jsdoc-type-annotations)

JSDoc type annotations are redundant in TypeScript source code. Do not declare
types in `@param` or `@return` blocks, do not write `@implements`, `@enum`,
`@private`, `@override` etc. on code that uses the `implements`, `enum`,
`private`, `override` etc. keywords.

### Make comments that actually add information [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#redundant-comments)

For non-exported symbols, sometimes the name and type of the function or
parameter is enough. Code will _usually_ benefit from more documentation than
just variable names though!

- Avoid comments that just restate the parameter name and type, e.g.


```ts
/** @param fooBarService The Bar service for the Foo application. */
```

- Because of this rule, `@param` and `@return` lines are only required when
they add information, and _may_ otherwise be omitted.


```ts
/**
* POSTs the request to start coffee brewing.
* @param amountLitres The amount to brew. Must fit the pot size!
*/
brew(amountLitres: number, logger: Logger) {
    // ...
}
```


#### Comments when calling a function [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#comments-when-calling-a-function)

‚ÄúParameter name‚Äù comments should be used whenever the method name and parameter
value do not sufficiently convey the meaning of the parameter.

Before adding these comments, consider refactoring the method to instead accept
an interface and destructure it to greatly improve call-site
readability.

Parameter name comments go before the parameter value, and include the
parameter name and a `=` suffix:

```ts
someFunction(obviousParam, /* shouldRender= */ true, /* name= */ 'hello');
```

Existing code may use a legacy parameter name comment style, which places these
comments ~after~ the parameter value and omits the `=`. Continuing to use this
style within the file for consistency is acceptable.

```ts
someFunction(obviousParam, true /* shouldRender */, 'hello' /* name */);
```

### Place documentation prior to decorators [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#place-documentation-prior-to-decorators)

When a class, method, or property have both decorators like `@Component` and
JsDoc, please make sure to write the JsDoc before the decorator.

- Do not write JsDoc between the Decorator and the decorated statement.


```ts
@Component({
    selector: 'foo',
    template: 'bar',
})
/** Component that prints "bar". */
export class FooComponent {}
```

- Write the JsDoc block before the Decorator.


```ts
/** Component that prints "bar". */
@Component({
    selector: 'foo',
    template: 'bar',
})
export class FooComponent {}
```


## Policies [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#policies)

### Consistency [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#consistency)

For any style question that isn't settled definitively by this specification, do
what the other code in the same file is already doing (be consistent). If that
doesn't resolve the question, consider emulating the other files in the same
directory.

Brand new files _must_ use Google Style, regardless of the style choices of
other files in the same package. When adding new code to a file that is not in
Google Style, reformatting the existing code first is recommended, subject to
the advice [below](https://google.github.io/styleguide/tsguide.html#reformatting-existing-code). If this reformatting is not
done, then new code _should_ be as consistent as possible with existing code in
the same file, but _must not_ violate the style guide.

#### Reformatting existing code [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#reformatting-existing-code)

You will occasionally encounter files in the codebase that are not in proper
Google Style. These may have come from an acquisition, or may have been written
before Google Style took a position on some issue, or may be in non-Google Style
for any other reason.

When updating the style of existing code, follow these guidelines.

1. It is not required to change all existing code to meet current style
guidelines. Reformatting existing code is a trade-off between code churn and
consistency. Style rules evolve over time and these kinds of tweaks to
maintain compliance would create unnecessary churn. However, if significant
changes are being made to a file it is expected that the file will be in
Google Style.
2. Be careful not to allow opportunistic style fixes to muddle the focus of a
CL. If you find yourself making a lot of style changes that aren‚Äôt critical
to the central focus of a CL, promote those changes to a separate CL.

### Deprecation [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#deprecation)

Mark deprecated methods, classes or interfaces with an `@deprecated` JSDoc
annotation. A deprecation comment must include simple, clear directions for
people to fix their call sites.

### Generated code: mostly exempt [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#generated-code)

Source code generated by the build process is not required to be in Google
Style. However, any generated identifiers that will be referenced from
hand-written source code must follow the naming requirements. As a special
exception, such identifiers are allowed to contain underscores, which may help
to avoid conflicts with hand-written identifiers.

#### Style guide goals [![](https://google.github.io/styleguide/include/link.png)](https://google.github.io/styleguide/tsguide.html\#style-guide-goals)

In general, engineers usually know best about what's needed in their code, so if
there are multiple options and the choice is situation dependent, we should let
decisions be made locally. So the default answer should be leave it out.

The following points are the exceptions, which are the reasons we have some
global rules. Evaluate your style guide proposal against the following:

1. **Code should avoid patterns that are known to cause problems, especially**
**for users new to the language.**

2. **Code across**
**projects should be consistent across**
**irrelevant variations.**

When there are two options that are equivalent in a superficial way, we
should consider choosing one just so we don't divergently evolve for no
reason and avoid pointless debates in code reviews.

Examples:

   - The capitalization style of names.
   - `x as T` syntax vs the equivalent `<T>x` syntax (disallowed).
   - `Array<[number, number]>` vs `[number, number][]`.
3. **Code should be maintainable in the long term.**

Code usually lives longer than the original author works on it, and the
TypeScript team must keep all of Google working into the future.

Examples:

   - We use software to automate changes to code, so code is autoformatted so
     it's easy for software to meet whitespace rules.
   - We require a single set of compiler flags, so a given TS library can be
     written assuming a specific set of flags, and users can always safely
     use a shared library.
   - Code must import the libraries it uses (strict deps) so that a
     refactor in a dependency doesn't change the dependencies of its users.
   - We ask users to write tests. Without tests we cannot have confidence
     that changes that we make to the language, don't break users.
4. **Code reviewers should be focused on improving the quality of the code, not**
**enforcing arbitrary rules.**

If it's possible to implement your rule as an

automated check that is often a good sign.
This also supports principle 3.

If it really just doesn't matter that much -- if it's an obscure corner of
the language or if it avoids a bug that is unlikely to occur -- it's
probably worth leaving out.


* * *

1. Namespace imports are often called 'module imports'¬†[‚Ü©](https://google.github.io/styleguide/tsguide.html#fnref1)

2. named imports are sometimes called 'destructuring
imports' because they use similar syntax to
destructuring assignments.¬†[‚Ü©](https://google.github.io/styleguide/tsguide.html#fnref2)

# Hosting a Reddit API Discord app on Cloudflare Workers

On this page

[Creating an app on Discord](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#creating-an-app-on-discord) [Adding bot permissions](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#adding-bot-permissions) [Creating your Cloudflare Worker](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#creating-your-cloudflare-worker) [Running locally](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#running-locally) [Deployment](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#deployment) [Code deep dive](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#code-deep-dive) [Next steps](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#next-steps)

When building Discord apps, your app can receive common events from the client as [webhooks](https://discord.com/developers/docs/resources/webhook) when users interact with your app through interactions like [application commands](https://discord.com/developers/docs/interactions/application-commands) or [message components](https://discord.com/developers/docs/components/reference).

Discord will send these events to a pre-configured HTTPS endpoint (called an Interactions Endpoint URL in an app's configuration) as a JSON payload with details about the event.

This tutorial walks through building a Discord app powered by [`r/aww`](https://www.reddit.com/r/aww) using JavaScript:

![Demo of Reddit API app](https://discord.com/assets/08deb779ff4b3133.webp)

All of the code for this app can be found [on GitHub](https://github.com/discord/cloudflare-sample-app).

### Features and technologies used

- [Discord Interactions API](https://discord.com/developers/docs/interactions/receiving-and-responding) (specifically slash commands)
- [Cloudflare Workers](https://workers.cloudflare.com/) for hosting
- [Reddit API](https://www.reddit.com/dev/api/) to send messages back to the user

* * *

## Creating an app on Discord

To start, we'll create the app through the [Discord Developer Dashboard](https://discord.com/developers/applications):

- Visit [https://discord.com/developers/applications](https://discord.com/developers/applications)
- Click `New Application`, and choose a name
- Copy your Public Key and Application ID, and put them somewhere locally (we'll need these later)

![IDs found in app settings](https://discord.com/assets/d4089824ab50ca54.webp)

- Now click on the Bot tab on the left sidebar.
- Grab the `token` for your bot, and store it somewhere safe (I like to put these tokens in a password manager like [1password](https://1password.com/) or [lastpass](https://www.lastpass.com/)).

For security reasons, you can only view your bot token once. If you misplace your token, you'll have to generate a new one.

## Adding bot permissions

Now we'll configure the bot with [permissions](https://discord.com/developers/docs/topics/permissions) required to create and use slash commands, as well as send messages in channels.

- Click on the `OAuth2` tab, and choose the `URL Generator`. Click the `bot` and `applications.commands` scopes.
- Check the boxes next to `Send Messages` and `Use Slash Commands`, then copy the `Generated URL`.

![Configuring bot permissions in app settings](https://discord.com/assets/a7a26a7368cdd079.webp)

- Paste the URL into the browser and follow the OAuth flow, selecting the server where you'd like to develop and test your bot.

## Creating your Cloudflare Worker

Cloudflare Workers are a convenient way to host Discord apps due to the free tier, simple development model, and automatically managed environment (no VMs!).

When using Cloudflare Workers, your app won't be able to access non-ephemeral CDN media. For example, trying to fetch an image like `https://cdn.discordapp.com/attachments/1234/56789/my_image.png` would result in a `403` error. Cloudflare Workers are still able to access ephemeral CDN media.

- Visit the [Cloudflare Dashboard](https://dash.cloudflare.com/)
- Click on the `Workers` tab, and create a new service using the same name as your Discord bot
- Make sure to [install the Wrangler CLI](https://developers.cloudflare.com/workers/cli-wrangler/install-update/) and set it up.

### Storing secrets

The production service needs access to some of the information we saved earlier. To set those variables, run:

Copy

```
$ wrangler secret put DISCORD_TOKEN
$ wrangler secret put DISCORD_PUBLIC_KEY
$ wrangler secret put DISCORD_APPLICATION_ID
```

You'll also need the Guild ID for the server where your app is installed. This can be found in the URL when you visit any channel in that server.

For example, if my URL was `https://discord.com/channels/123456/789101112`, the Guild ID is the first number‚Äîin this case `123456`.

Once you know your Guild ID, set that variable as well:

Copy

```
$ wrangler secret put DISCORD_TEST_GUILD_ID
```

## Running locally

This depends on the beta version of the `wrangler` package, which better supports ESM on Cloudflare Workers.

Let's start by cloning the repository and installing dependencies. This requires at least v16 of [Node.js](https://nodejs.org/en/):

Copy

```
$ npm install
```

### Project structure

A brief look at the cloned app's project structure:

Copy

```
‚îú‚îÄ‚îÄ .github/workflows/ci.yaml -> GitHub Action configuration
‚îú‚îÄ‚îÄ src
‚îÇ   ‚îú‚îÄ‚îÄ commands.js           -> JSON payloads for commands
‚îÇ   ‚îú‚îÄ‚îÄ reddit.js             -> Interactions with the Reddit API
‚îÇ   ‚îú‚îÄ‚îÄ register.js           -> Sets up commands with the Discord API
‚îÇ   ‚îú‚îÄ‚îÄ server.js             -> Discord app logic and routing
‚îú‚îÄ‚îÄ test
|   ‚îú‚îÄ‚îÄ test.js               -> Tests for app
‚îú‚îÄ‚îÄ wrangler.toml             -> Configuration for Cloudflare Workers
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ renovate.json             -> Configuration for repo automation
‚îú‚îÄ‚îÄ .eslintrc.json
‚îú‚îÄ‚îÄ .prettierignore
‚îú‚îÄ‚îÄ .prettierrc.json
‚îî‚îÄ‚îÄ .gitignore
```

### Registering commands

Before testing our app, we need to register our desired slash commands. For this app, we'll have a `/awwww` command, and a `/invite` command. The name and description for these are kept separate in `commands.js`:

Copy

```js
export const AWW_COMMAND = {
  name: 'awwww',
  description: 'Drop some cuteness on this channel.',
};

export const INVITE_COMMAND = {
  name: 'invite',
  description: 'Get an invite link to add the bot to your server',
};
```

The code to register commands lives in `register.js`. Commands can be [registered globally](https://discord.com/developers/docs/interactions/application-commands#create-global-application-command), making them available for all servers with the app installed, or they can be [registered on a single server](https://discord.com/developers/docs/interactions/application-commands#create-guild-application-command).

In this example - we'll just focus on global commands:

Copy

```js
import { AWW_COMMAND, INVITE_COMMAND } from './commands.js';
import fetch from 'node-fetch';

/**
 * This file is meant to be run from the command line, and is not used by the
 * application server.  It's allowed to use node.js primitives, and only needs
 * to be run once.
 */

const token = process.env.DISCORD_TOKEN;
const applicationId = process.env.DISCORD_APPLICATION_ID;

if (!token) {
  throw new Error('The DISCORD_TOKEN environment variable is required.');
}
if (!applicationId) {
  throw new Error(
    'The DISCORD_APPLICATION_ID environment variable is required.'
  );
}

/**
 * Register all commands globally.  This can take o(minutes), so wait until
 * you're sure these are the commands you want.
 */
async function registerGlobalCommands() {
  const url = `https://discord.com/api/v10/applications/${applicationId}/commands`;
  await registerCommands(url);
}

async function registerCommands(url) {
  const response = await fetch(url, {
    headers: {
      'Content-Type': 'application/json',
      Authorization: `Bot ${token}`,
    },
    method: 'PUT',
    body: JSON.stringify([AWW_COMMAND, INVITE_COMMAND]),
  });

  if (response.ok) {
    console.log('Registered all commands');
  } else {
    console.error('Error registering commands');
    const text = await response.text();
    console.error(text);
  }
  return response;
}

await registerGlobalCommands();
```

### Running the server

This command needs to be run locally, once before getting started:

Copy

```
$ DISCORD_TOKEN=**** DISCORD_APPLICATION_ID=**** node src/register.js
```

We're finally ready to run this code locally! Let's start by running our local development server:

Copy

```
$ npm run dev
```

### Setting up ngrok

When a user types a slash command, Discord will send an HTTP request to a public endpoint. During local development this can be a little challenging, so we're going to use [a tool called `ngrok`](https://ngrok.com/) to create an HTTP tunnel.

Copy

```
$ npm run ngrok
```

![ngrok forwarding address](https://discord.com/assets/68006d409796838a.webp)

This is going to bounce requests off of an external endpoint, and forward them to your machine. Copy the HTTPS link provided by the tool. It should look something like `https://8098-24-22-245-250.ngrok.io`.

Now head back to the Discord Developer Dashboard, and update the `Interactions Endpoint URL` for your app:

![Interactions Endpoint URL](https://discord.com/assets/d3d5407fde1edb01.webp)

This is the process we'll use for local testing and development. When you've published your app to Cloudflare, you will want to update this field to use your Cloudflare Worker URL.

## Deployment

This repository is set up to automatically deploy to Cloudflare Workers when new changes land on the `main` branch. To deploy manually, run `npm run publish`, which uses the `wrangler publish` command under the hood.

Publishing via a GitHub Action requires obtaining an [API Token and your Account ID from Cloudflare](https://developers.cloudflare.com/workers/cli-wrangler/authentication/). These are stored [as secrets in the GitHub repository](https://docs.github.com/en/actions/security-guides/encrypted-secrets), making them available to GitHub Actions.

The following configuration in `.github/workflows/ci.yaml` demonstrates how to tie it all together:

Copy

```yaml
release:
  if: github.ref == 'refs/heads/main'
  runs-on: ubuntu-latest
  needs: [test, lint]
  steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v2
      with:
        node-version: 16
    - run: npm install
    - run: npm run publish
      env:
        CF_API_TOKEN: ${{ secrets.CF_API_TOKEN }}
        CF_ACCOUNT_ID: ${{ secrets.CF_ACCOUNT_ID }}
```

## Code deep dive

Most of the interesting code in this app lives in `src/server.js`. Cloudflare Workers require exposing a `fetch` function, which is called as the entry point for each request. This code will largely do two things for us: validate the request is valid and actually came from Discord, and hand the request over to a router to help give us a little more control over execution.

Copy

```js
export default {
  /**
   * Every request to a worker will start in the `fetch` method.
   * Verify the signature with the request, and dispatch to the router.
   * @param {*} request A Fetch Request object
   * @param {*} env A map of key/value pairs with env vars and secrets from the cloudflare env.
   * @returns
   */
  async fetch(request, env) {
    if (request.method === 'POST') {
      // Using the incoming headers, verify this request actually came from discord.
      const signature = request.headers.get('x-signature-ed25519');
      const timestamp = request.headers.get('x-signature-timestamp');
      const body = await request.clone().arrayBuffer();
      const isValidRequest = verifyKey(
        body,
        signature,
        timestamp,
        env.DISCORD_PUBLIC_KEY
      );
      if (!isValidRequest) {
        console.error('Invalid Request');
        return new Response('Bad request signature.', { status: 401 });
      }
    }

    // Dispatch the request to the appropriate route
    return router.handle(request, env);
  },
};
```

All of the API calls from Discord in this example will be POSTed to `/`. From here, we will use the [`discord-interactions`](https://github.com/discord/discord-interactions-js) npm module to help us interpret the event, and to send results.

Copy

```js
/**
 * Main route for all requests sent from Discord.  All incoming messages will
 * include a JSON payload described here:
 * https://discord.com/developers/docs/interactions/receiving-and-responding#interaction-object
 */
router.post('/', async (request, env) => {
  const message = await request.json();
  console.log(message);
  if (message.type === InteractionType.PING) {
    // The `PING` message is used during the initial webhook handshake, and is
    // required to configure the webhook in the developer portal.
    console.log('Handling Ping request');
    return new JsonResponse({
      type: InteractionResponseType.PONG,
    });
  }

  if (message.type === InteractionType.APPLICATION_COMMAND) {
    // Most user commands will come as `APPLICATION_COMMAND`.
    switch (message.data.name.toLowerCase()) {
      case AWW_COMMAND.name.toLowerCase(): {
        console.log('handling cute request');
        const cuteUrl = await getCuteUrl();
        return new JsonResponse({
          type: InteractionResponseType.CHANNEL_MESSAGE_WITH_SOURCE,
          data: {
            content: cuteUrl,
          },
        });
      }
      case INVITE_COMMAND.name.toLowerCase(): {
        const applicationId = env.DISCORD_APPLICATION_ID;
        const INVITE_URL = `https://discord.com/oauth2/authorize?client_id=${applicationId}&scope=applications.commands`;
        return new JsonResponse({
          type: InteractionResponseType.CHANNEL_MESSAGE_WITH_SOURCE,
          data: {
            content: INVITE_URL,
            flags: InteractionResponseFlags.EPHEMERAL,
          },
        });
      }
      default:
        console.error('Unknown Command');
        return new JsonResponse({ error: 'Unknown Type' }, { status: 400 });
    }
  }

  console.error('Unknown Type');
  return new JsonResponse({ error: 'Unknown Type' }, { status: 400 });
});
```

## Next steps

In case you need to reference any of the code, you can find the repo [on GitHub](https://github.com/discord/cloudflare-sample-app)

With your app built and deployed, you can start customizing it to be your own:

- Use [message components](https://discord.com/developers/docs/components/reference) in your app to add more interactivity (like buttons and select menus).
- Take a look at different [public APIs](https://github.com/public-apis/public-apis) on GitHub.
- Join the [Discord Developers server](https://discord.gg/discord-developers) to ask questions about the API, attend events hosted by the Discord API team, and interact with other developers.

On this page

[Creating an app on Discord](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#creating-an-app-on-discord) [Adding bot permissions](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#adding-bot-permissions) [Creating your Cloudflare Worker](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#creating-your-cloudflare-worker) [Running locally](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#running-locally) [Deployment](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#deployment) [Code deep dive](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#code-deep-dive) [Next steps](https://discord.com/developers/docs/tutorials/hosting-on-cloudflare-workers#next-steps)

‚ö†Ô∏è

**Security Update**: npm classic token creation is now disabled. Existing classic tokens will be revoked on **December 9, 2025**. Migrate to trusted publishing or granular access tokens to avoid disruption. [Learn more](https://gh.io/npm-token-changes).

√ó

# google-trends-api

4.9.2¬†‚Ä¢¬†Public¬†‚Ä¢¬†Published 5 years ago

- [Readme](https://www.npmjs.com/package/google-trends-api?activeTab=readme)
- [Code Beta](https://www.npmjs.com/package/google-trends-api?activeTab=code)
- [0 Dependencies](https://www.npmjs.com/package/google-trends-api?activeTab=dependencies)
- [18 Dependents](https://www.npmjs.com/package/google-trends-api?activeTab=dependents)
- [42 Versions](https://www.npmjs.com/package/google-trends-api?activeTab=versions)

# google-trends-api

[![NPM](https://nodei.co/npm/google-trends-api.png?downloads=true&downloadRank=true&stars=true)](https://nodei.co/npm/google-trends-api/)

[![npm version](https://badge.fury.io/js/google-trends-api.svg)](https://badge.fury.io/js/google-trends-api)[![Build status](https://img.shields.io/travis/pat310/google-trends-api.svg?style=flat-square)](https://travis-ci.org/pat310/google-trends-api/)[![Coverage Status](https://coveralls.io/repos/github/pat310/google-trends-api/badge.svg?branch=master)](https://coveralls.io/github/pat310/google-trends-api?branch=master)[![Code Climate](https://codeclimate.com/github/pat310/google-trends-api/badges/gpa.svg)](https://codeclimate.com/github/pat310/google-trends-api)[![Dependency Status](https://img.shields.io/david/pat310/google-trends-api.svg?style=flat-square)](https://david-dm.org/pat310/google-trends-api)[![Known Vulnerabilities](https://snyk.io/test/github/pat310/google-trends-api/badge.svg)](https://snyk.io/test/github/pat310/google-trends-api)

## v3 to v4

[Big changes](https://github.com/pat310/google-trends-api/blob/HEAD/CHANGES.md)! The old google-trends endpoints are deprecated and are heavily throttled so this library has changed significantly. You can choose to download the old version via `npm install google-trends-api@3.0.2` but it is discouraged.

## Introduction

This library provides an API layer to [google trends](https://www.google.com/trends/) data. Due to CORS restrictions, this library is intended to be used in node. It is constantly being expanded and improved so please check back frequently. Also, please feel free to contribute to make the library even better! üê∂

### Syntax

```
const googleTrends = require('google-trends-api');

googleTrends.apiMethod(optionsObject, [callback])
```

#### Parameters

**optionsObject**
An object with the following options keys:

- **keyword** Target search term(s) `string` or `array` if you wish to compare search terms **required**
- **startTime** Start of time period of interest (`new Date()` object). If `startTime` is not provided, a date of January 1, 2004 is assumed (this is the oldest available google trends data)
- **endTime** End of time period of interest (`new Date()` object). If `endTime` is not provided, the current date is selected.
- **geo** Location of interest (`string` or `array` if you wish to provide separate locations for each keyword).
- **hl** Preferred language (`string` [defaults to english](https://sites.google.com/site/tomihasa/google-language-codes))
- **timezone** Timezone (`number` defaults to the time zone difference, in minutes, from UTC to current locale (host system settings))
- **category** Category to search within (`number` defaults to [all categories](https://github.com/pat310/google-trends-api/wiki/Google-Trends-Categories))
- **property** Google property to filter on. Defaults to web search. (enumerated `string` \['images', 'news', 'youtube' or 'froogle'\] where froogle is Google Shopping results)
- **resolution** Granularity of the geo search (enumerated `string` \['COUNTRY', 'REGION', 'CITY', 'DMA'\]). `resolution` is specific to the [interestByRegion](https://www.npmjs.com/package/google-trends-api#interestByRegion) method.
- **granularTimeResolution** Boolean that dictates if the results should be given in a finer time resolution (if `startTime` and `endTime` is less than one day, this should be set to `true`)

**callback**
Optional callback function where the first parameter is an error and the second parameter is the result. If no callback is provided, then a promise is returned.

## Table of contents

- [Installation](https://www.npmjs.com/package/google-trends-api#installation)
- [API](https://www.npmjs.com/package/google-trends-api#api)  - [Promises](https://www.npmjs.com/package/google-trends-api#promises)
  - [Callbacks](https://www.npmjs.com/package/google-trends-api#callbacks)
  - [Proxy Server](https://www.npmjs.com/package/google-trends-api#proxy-server)
  - [Examples](https://www.npmjs.com/package/google-trends-api#examples)
  - [API Methods](https://www.npmjs.com/package/google-trends-api#api-methods)    - [autoComplete](https://www.npmjs.com/package/google-trends-api#autocomplete)
    - [dailyTrends](https://www.npmjs.com/package/google-trends-api#dailyTrends)
    - [interestOverTime](https://www.npmjs.com/package/google-trends-api#interestovertime)
    - [interestByRegion](https://www.npmjs.com/package/google-trends-api#interestbyregion)
    - [realTimeTrends](https://www.npmjs.com/package/google-trends-api#realTimeTrends)
    - [relatedQueries](https://www.npmjs.com/package/google-trends-api#relatedqueries)
    - [relatedTopics](https://www.npmjs.com/package/google-trends-api#relatedtopics)
- [Geo help](https://www.npmjs.com/package/google-trends-api#geo-help)
- [List of categories](https://github.com/pat310/google-trends-api/wiki/Google-Trends-Categories)
- [Big Thanks](https://www.npmjs.com/package/google-trends-api#big-thanks)

* * *

## Installation

To install this package, clone this git repository and include it in your project's node\_modules or simply:

```
npm install google-trends-api
```

Require google-trends-api in your script and give it a variable name:

```
const googleTrends = require('google-trends-api');
```

You will now be able to access methods on `googleTrends`. See the [API Methods section](https://www.npmjs.com/package/google-trends-api#api-methods) below to see the methods available and their syntax.

[back to top](https://www.npmjs.com/package/google-trends-api#introduction)

* * *

## API

### Promises

By default, all the API's return a promise for the results. Example:

```
googleTrends.interestOverTime({keyword: 'Women\'s march'})
.then(function(results){
  console.log('These results are awesome', results);
})
.catch(function(err){
  console.error('Oh no there was an error', err);
});
```

### Callbacks

All API methods can alternatively take a callback function as the second parameter. For example:

```
googleTrends.interestOverTime({keyword: 'Women\'s march'}, function(err, results){
  if(err) console.error('there was an error!', err);
  else console.log('my sweet sweet results', results);
})
```

### Proxy Server

A proxy server can be used by specifying an http agent as part of the query. This example uses [https-proxy-agent](https://www.npmjs.com/package/https-proxy-agent)

```
const HttpsProxyAgent = require('https-proxy-agent');

let proxyAgent =  new HttpsProxyAgent('http://proxy-host:8888/');

let query = {
    keyword: 'Women\'s march',
    agent: proxyAgent
};

googleTrends.interestOverTime(query)
.then(function(results){
  console.log('These proxied results are incredible', results);
})
.catch(function(err){
  console.error('Oh no there was an error, double check your proxy settings', err);
});
```

### Multiple Keywords

Compare multiple keywords with any of the api methods by supplying an `array` instead of a single `string`

```
googleTrends.interestOverTime({keyword: ['Women\'s march', 'Trump Inauguration']})
.then(function(results){
  console.log('These results are awesome', results);
})
.catch(function(err){
  console.error('Oh no there was an error', err);
});
```

### Examples

There are examples available for each API method in the root directory of the module. **Note:** Each example in [examples.js](https://github.com/pat310/google-trends-api/blob/HEAD/examples.js) needs to be uncommented.

### API Methods

The following API methods are available:

- [autoComplete](https://www.npmjs.com/package/google-trends-api#autocomplete): Returns the results from the "Add a search term" input box in the google trends UI. These results (Topics) can then be used in the other API methods. **Note**: Search terms and Topics are measured differently, so `relatedTopics` will not work with comparisons that contain both Search terms and Topics.

- [dailyTrends](https://www.npmjs.com/package/google-trends-api#dailyTrends): Daily Search Trends highlights searches that jumped significantly in traffic among all searches over the past 24 hours and updates hourly. These search trends show the specific queries that were searched, and the absolute number of searches made. 20 daily trending search results are returned.You can search retroactively for up to 15 days in the past.

- [interestOverTime](https://www.npmjs.com/package/google-trends-api#interestovertime): Numbers represent search interest relative to the highest point on the chart for the given region and time. A value of 100 is the peak popularity for the term. A value of 50 means that the term is half as popular. Likewise a score of 0 means the term was less than 1% as popular as the peak. If you use multiple keywords for a comparison, the return data will also contain an average result for each keyword.

- [interestByRegion](https://www.npmjs.com/package/google-trends-api#interestbyregion): See in which location your term was most popular during the specified time frame. Values are calculated on a scale from 0 to 100, where 100 is the location with the most popularity as a fraction of total searches in that location, a value of 50 indicates a location which is half as popular, and a value of 0 indicates a location where the term was less than 1% as popular as the peak.



**Note:** A higher value means a higher proportion of all queries, not a higher absolute query count. So a tiny country where 80% of the queries are for "bananas" will get twice the score of a giant country where only 40% of the queries are for "bananas".

- [realTimeTrends](https://www.npmjs.com/package/google-trends-api#realTimeTrends): Realtime Search Trends highlight stories that are trending across Google surfaces within the last 24 hours, and are updated in realtime. These stories are a collection of Knowledge Graph topics, Search interest, trending YouTube videos, and/or Google News articles detected by Google's algorithms. 13 real time trending stories are returned.

- [relatedQueries](https://www.npmjs.com/package/google-trends-api#relatedqueries): Users searching for your term also searched for these queries. The following metrics are returned:
  - **Top** \- The most popular search queries. Scoring is on a relative scale where a value of 100 is the most commonly searched query, 50 is a query searched half as often, and a value of 0 is a query searched for less than 1% as often as the most popular query.
  - **Rising** \- Queries with the biggest increase in search frequency since the last time period. Results marked "Breakout" had a tremendous increase, probably because these queries are new and had few (if any) prior searches.
- [relatedTopics](https://www.npmjs.com/package/google-trends-api#relatedtopics): Users searching for your term also searched for these topics. The following metrics are returned:
  - **Top** \- The most popular topics. Scoring is on a relative scale where a value of 100 is the most commonly searched topic, a value of 50 is a topic searched half as often, and a value of 0 is a topic searched for less than 1% as often as the most popular topic.
  - **Rising** \- Related topics with the biggest increase in search frequency since the last time period. Results marked "Breakout" had a tremendous increase, probably because these topics are new and had few (if any) prior searches.

[back to top](https://www.npmjs.com/package/google-trends-api#introduction)

* * *

#### autoComplete

- Results from the "add a search term" input box in the google trends UI\*

#### Syntax

`googleTrends.autoComplete({keyword: string}, cbFunc)`

Requires an `object` as the first parameter with the following keys:

- `keyword` \- **required** \- type `string` \- the search term of interest
- `hl` \- _optional_ \- type `string` \- preferred language code for results (defaults to english)

Optional callback `function` as the second parameter (otherwise returns a promise)

##### Example

Returning the auto-complete results for 'Back to School'

###### Input

```
googleTrends.autoComplete({keyword: 'Back to School'})
.then(function(results) {
  console.log(results);
})
.catch(function(err) {
  console.error(err);
})
```

###### Output

```
{"default":{"topics":[{"mid":"/m/0414j6","title":"Back to School","type":"1986 film"},{"mid":"/m/068pw8","title":"Back to school","type":"Topic"},{"mid":"/m/04vwgn","title":"Fight Back to School","type":"1991 film"},{"mid":"/m/05357_","title":"Tax holiday","type":"Holiday"},{"mid":"/m/02pb6kt","title":"Fight Back to School II","type":"1992 film"}]}}
```

**Note:** You can then use these results in the other API methods. For example, if you wanted `interestOverTime` for 'Back to School' where the type is 'Topic', you would then use:
`googleTrends.interestOverTime({keyword: '/m/068pw8'})`

[back to top](https://www.npmjs.com/package/google-trends-api#introduction)

* * *

#### dailyTrends

_Daily Search Trends highlights searches that jumped significantly in traffic among all searches over the past 24 hours and updates hourly. These search trends show the specific queries that were searched, and the absolute number of searches made. 20 daily trending search results are returned_

##### Syntax

`googleTrends.dailyTrends({ geo: string }, cbFunc)`

Requires an `object` as the first parameter with the following keys:

- `geo` \- **required** \- type `string` \- geocode for a country. For example, `geo: 'US'` will target United States or `geo: 'FR'` will target France.
- `hl` \- _optional_ \- type `string` \- preferred language code for results (defaults to english).
- `timezone` \- _optional_ \- type `number` \- preferred timezone (defaults to the time zone difference, in minutes, from UTC to current locale (host system settings))
- `trendDate` \- _optional_ \- type `Date` object - the date you are interesting in retrieving trends information for (defaults to the current date). **Note that querying for a date more than 15 days in the past will result in an error.**

Optional callback `function` as the second parameter (otherwise returns a promise)

##### Example

Returning real time trending stories for the United States region.

###### Input

```
googleTrends.dailyTrends({
  trendDate: new Date('2019-01-10'),
  geo: 'US',
}, function(err, results) {
  if (err) {
    console.log(err);
  }else{
    console.log(results);
  }
});
```

###### Output

```
{
  default : [Object]{
    trendingSearchesDays : [Array]
      [0] : [Object]{
        date : String
        formattedDate: String
        trendingSearches : [Array]{
          [0] : [Object] //First trending result
        }
      [1] : [Object]{
        date : String
        formattedDate: String
        trendingSearches : [Array]{
          [0] : [Object] //first trending result
          ...
          [19] : [Object] //20th trending result
        }
      }
    }
    endDateForNextRequest : String,
    rssFeedPageUrl : String,
  }
}
```

[back to top](https://www.npmjs.com/package/google-trends-api#introduction)

* * *

#### interestOverTime

_Search interest relative to the highest point on the chart for the given region and time (100 is the peak popularity for the term)_

##### Syntax

`googleTrends.interestOverTime({keyword: string, startTime: Date, endTime: Date, geo: string}, cbFunc)`

Requires an `object` as the first parameter with the following keys:

- `keyword` \- **required** \- type `string` or `array` \- the search term(s) of interest
- `startTime` \- _optional_ \- type `Date` object - the start of the time range of interest (defaults to `new Date('2004-01-01')` if not supplied)
- `endTime` \- _optional_ \- type `Date` object - the end of the time range of interest (defaults to `new Date(Date.now())` if not supplied)
- `geo` \- _optional_ \- type `string` or `array` \- geocode(s) for a country, region, or DMA depending on the granularity required (defaults to worldwide). For example, `geo: 'US-CA-800'` will target the Bakersfield, California, United States or `geo: 'US'` will just target the US. Passing `geo: ['US-CA, US-VA'], keyword: ['wine', 'peanuts']` will search for wine in California and peanuts in Virginia.
- `hl` \- _optional_ \- type `string` \- preferred language code for results (defaults to english)
- `timezone` \- _optional_ \- type `number` \- preferred timezone (defaults to the time zone difference, in minutes, from UTC to current locale (host system settings))
- `category` \- _optional_ \- type `number` \- a number corresponding to a particular category to query within (defaults to all categories), see the [category wiki](https://github.com/pat310/google-trends-api/wiki/Google-Trends-Categories) for a complete list
- `granularTimeResolution` \- _optional_ \- type `boolean` \- if `true`, will try to return results to a finer time resolution (only relevant for `startTime` and `endTime` less than one week)

Optional callback `function` as the second parameter (otherwise returns a promise)

The resolution of the search changes automatically depending on the search duration. The wider the duration window, the worse the resolution (for example, a search duration with a `startTime` and `endTime` that ends years apart will return a resolution in months, while a search duration with a `startTime` and `endTime` a few hours apart will return a resolution in minutes).

##### Example 1

Returning the search interest over time for 'Valentines Day' (by default from 2004-01-01 to today)

###### Input

```
googleTrends.interestOverTime({keyword: 'Valentines Day'})
.then(function(results){
  console.log(results);
})
.catch(function(err){
  console.error(err);
});
```

###### Output

```
{"default":{"timelineData":[{"time":"1072915200","formattedTime":"Jan 2004","formattedAxisTime":"Jan 1, 2004","value":[26],"formattedValue":["26"]},{"time":"1075593600","formattedTime":"Feb 2004","formattedAxisTime":"Feb 1, 2004","value":[74],"formattedValue":["74"]},\
...\
{"time":"1483228800","formattedTime":"Jan 2017","formattedAxisTime":"Jan 1, 2017","value":[18],"formattedValue":["18"]},{"time":"1485907200","formattedTime":"Feb 2017","formattedAxisTime":"Feb 1, 2017","value":[72],"formattedValue":["72"]}],"averages":[]}}
```

##### Example 2

Returning the search interest over time for 'Valentines Day' from the past four hours. Note that the resolution is by minute since our query duration is shorter.

###### Input

```
googleTrends.interestOverTime({keyword: 'Valentines Day', startTime: new Date(Date.now() - (4 * 60 * 60 * 1000))}, function(err, results) {
  if (err) console.log('oh no error!', err);
  else console.log(results);
});
```

###### Output

```
{"default":{"timelineData":[{"time":"1487026800","formattedTime":"Feb 13, 2017 at 6:00 PM","formattedAxisTime":"6:00 PM","value":[49],"formattedValue":["49"]},{"time":"1487026860","formattedTime":"Feb 13, 2017 at 6:01 PM","formattedAxisTime":"6:01 PM","value":[50],"formattedValue":["50"]},\
...\
{"time":"1487040180","formattedTime":"Feb 13, 2017 at 9:43 PM","formattedAxisTime":"9:43 PM","value":[88],"formattedValue":["88"]},{"time":"1487040240","formattedTime":"Feb 13, 2017 at 9:44 PM","formattedAxisTime":"9:44 PM","value":[81],"formattedValue":["81"]}],"averages":[]}}
```

[back to top](https://www.npmjs.com/package/google-trends-api#introduction)

* * *

#### interestByRegion

_See in which location your term was most popular during the specified time frame. Values are calculated on a scale from 0 to 100, where 100 is the location with the most popularity as a fraction of total searches in that location._

##### Syntax

`googleTrends.interestByRegion({keyword: string, startTime: Date, endTime: Date, geo: string, resolution: string}, cbFunc)`

Requires an `object` as the first parameter with the following keys:

- `keyword` \- **required** \- type `string` or `array` \- the search term(s) of interest
- `startTime` \- _optional_ \- type `Date` object - the start of the time range of interest (defaults to `new Date('2004-01-01')` if not supplied)
- `endTime` \- _optional_ \- type `Date` object - the end of the time range of interest (defaults to `new Date(Date.now())` if not supplied)
- `geo` \- _optional_ \- type `string` or `array` \- geocode(s) for a country, region, or DMA depending on the granularity required (defaults to worldwide). For example, `geo: 'US-CA-800'` will target the Bakersfield, California, United States or `geo: 'US'` will just target the US. Passing `geo: ['US-CA, US-VA'], keyword: ['wine', 'peanuts']` will search for wine in California and peanuts in Virginia.
- `resolution` \- _optional_ \- type `enumerated string` either `COUNTRY`, `REGION`, `CITY` or `DMA`. Resolution is selected by default otherwise. Trying to select a resolution larger than a specified `geo` will return an error.
- `hl` \- _optional_ \- type `string` \- preferred language code for results (defaults to english)
for results (defaults to english)
- `timezone` \- _optional_ \- type `number` \- preferred timezone (defaults to the time zone difference, in minutes, from UTC to current locale (host system settings))
- `category` \- _optional_ \- type `number` \- a number corresponding to a particular category to query within (defaults to all categories), see the [category wiki](https://github.com/pat310/google-trends-api/wiki/Google-Trends-Categories) for a complete list

Optional callback `function` as the second parameter (otherwise returns a promise)

##### Example 1

Returning the search interest by cities around the world for 'Donald Trump' from February 01, 2017 to February 06, 2017.

###### Input

```
googleTrends.interestByRegion({keyword: 'Donald Trump', startTime: new Date('2017-02-01'), endTime: new Date('2017-02-06'), resolution: 'CITY'})
.then((res) => {
  console.log(res);
})
.catch((err) => {
  console.log(err);
})
```

###### Output

```
{"default":{"geoMapData":[{"coordinates":{"lat":18.594395,"lng":-72.3074326},"geoName":"Port-au-Prince","value":[100],"formattedValue":["100"],"maxValueIndex":0},{"coordinates":{"lat":43.467517,"lng":-79.6876659},"geoName":"Oakville","value":[90],"formattedValue":["90"],"maxValueIndex":0},\
...\
{"coordinates":{"lat":40.9312099,"lng":-73.8987469},"geoName":"Yonkers","value":[69],"formattedValue":["69"],"maxValueIndex":0}]}}
```

##### Example 2

Returning the search interest by cities in California for 'Donald Trump' from February 01, 2017 to February 06, 2017.

###### Input

```
googleTrends.interestByRegion({keyword: 'Donald Trump', startTime: new Date('2017-02-01'), endTime: new Date('2017-02-06'), geo: 'US-CA'})
.then((res) => {
  console.log(res);
})
.catch((err) => {
  console.log(err);
})
```

###### Output

```
{"default":{"geoMapData":[{"geoCode":"807","geoName":"San Francisco-Oakland-San Jose CA","value":[100],"formattedValue":["100"],"maxValueIndex":0},{"geoCode":"828","geoName":"Monterey-Salinas CA","value":[100],"formattedValue":["100"],"maxValueIndex":0},\
...\
{"geoCode":"811","geoName":"Reno NV","value":[12],"formattedValue":["12"],"maxValueIndex":0},{"geoCode":"813","geoName":"Medford-Klamath Falls OR","value":[4],"formattedValue":["4"],"maxValueIndex":0}]}}
```

[back to top](https://www.npmjs.com/package/google-trends-api#introduction)

* * *

#### realtimeTrends

_Realtime Search Trends highlight stories that are trending across Google surfaces within the last 24 hours, and are updated in realtime. 13 real time trending stories are returned_

##### Syntax

`googleTrends.realTimeTrends({ geo: string }, cbFunc)`

Requires an `object` as the first parameter with the following keys:

- `geo` \- **required** \- type `string` \- geocode for a country. For example, `geo: 'US'` will target United States or `geo: 'FR'` will target France.
- `hl` \- _optional_ \- type `string` \- preferred language code for results (defaults to english)
for results (defaults to english)
- `timezone` \- _optional_ \- type `number` \- preferred timezone (defaults to the time zone difference, in minutes, from UTC to current locale (host system settings))
- `category` \- _optional_ \- type `string` \- a string corresponding to a particular category to query within (defaults to all categories):
All : 'all'
Entertainment: 'e'
Business : 'b'
Science/Tech : 't'
Health : 'm'
Sports : 's'
Top Stories : 'h'

Optional callback `function` as the second parameter (otherwise returns a promise)

##### Example

Returning real time trending stories for the United States region.

###### Input

```
googleTrends.realTimeTrends({
    geo: 'US',
    category: 'all',
}, function(err, results) {
    if (err) {
       console.log(err);
    } else {
      console.log(results);
    }
});
```

###### Output

```
{
  featuredStoryIds : [Array], // Empty
  trendingStoryIds : [Array], // 300 trending story IDs
  storySummaries : [Object]
    {
    featuredStories : [Array], // Empty
    trendingStories : [Array], // 13 top trending stories
    },
  date : "Date-String",
  hideAllImages : Boolean,
}
```

[back to top](https://www.npmjs.com/package/google-trends-api#introduction)

* * *

#### relatedQueries

_Users searching for your term also searched for these queries._

##### Syntax

`googleTrends.relatedQueries({keyword: string, startTime: Date, endTime: Date, geo: string}, cbFunc)`

Requires an `object` as the first parameter with the following keys:

- `keyword` \- **required** \- type `string` or `array` \- the search term(s) of interest
- `startTime` \- _optional_ \- type `Date` object - the start of the time range of interest (defaults to `new Date('2004-01-01')` if not supplied)
- `endTime` \- _optional_ \- type `Date` object - the end of the time range of interest (defaults to `new Date(Date.now())` if not supplied)
- `geo` \- _optional_ \- type `string` or `array` \- geocode(s) for a country, region, or DMA depending on the granularity required (defaults to worldwide). For example, `geo: 'US-CA-800'` will target the Bakersfield, California, United States or `geo: 'US'` will just target the US. Passing `geo: ['US-CA, US-VA'], keyword: ['wine', 'peanuts']` will search for wine in California and peanuts in Virginia.
- `hl` \- _optional_ \- type `string` \- preferred language code for results (defaults to english)
for results (defaults to english)
- `timezone` \- _optional_ \- type `number` \- preferred timezone (defaults to the time zone difference, in minutes, from UTC to current locale (host system settings))
- `category` \- _optional_ \- type `number` \- a number corresponding to a particular category to query within (defaults to all categories), see the [category wiki](https://github.com/pat310/google-trends-api/wiki/Google-Trends-Categories) for a complete list

Optional callback `function` as the second parameter (otherwise returns a promise)

##### Example

Returning top related queries for 'Westminster Dog show' with default startTime, endTime, and geo categories

###### Input

```
googleTrends.relatedQueries({keyword: 'Westminster Dog Show'})
.then((res) => {
  console.log(res);
})
.catch((err) => {
  console.log(err);
})
```

###### Output

```
{"default":{"rankedList":[{"rankedKeyword":[{"query":"dog show 2016","value":100,"formattedValue":"100","link":"/"},{"query":"2016 westminster dog show","value":95,"formattedValue":"95","link":"/"},\
...\
{"query":"dogs","value":20,"formattedValue":"20","link":"/"}]},{"rankedKeyword":[{"query":"dog show 2016","value":836500,"formattedValue":"Breakout","link":"/"},{"query":"2016 westminster dog show","value":811550,"formattedValue":"Breakout","link":"/"},\
...\
{"query":"who won the westminster dog show","value":59000,"formattedValue":"Breakout","link":"/"}]}]}}
```

[back to top](https://www.npmjs.com/package/google-trends-api#introduction)

* * *

#### relatedTopics

_Users searching for your term also searched for these topics_

##### Syntax

`googleTrends.relatedTopics({keyword: string, startTime: Date, endTime: Date, geo: string}, cbFunc)`

Requires an `object` as the first parameter with the following keys:

- `keyword` \- **required** \- type `string` or `array` \- the search term(s) of interest
- `startTime` \- _optional_ \- type `Date` object - the start of the time range of interest (defaults to `new Date('2004-01-01')` if not supplied)
- `endTime` \- _optional_ \- type `Date` object - the end of the time range of interest (defaults to `new Date(Date.now())` if not supplied)
- `geo` \- _optional_ \- type `string` or `array` \- geocode(s) for a country, region, or DMA depending on the granularity required (defaults to worldwide). For example, `geo: 'US-CA-800'` will target the Bakersfield, California, United States or `geo: 'US'` will just target the US. Passing `geo: ['US-CA, US-VA'], keyword: ['wine', 'peanuts']` will search for wine in California and peanuts in Virginia.
- `hl` \- _optional_ \- type `string` \- preferred language code for results (defaults to english)
for results (defaults to english)
- `timezone` \- _optional_ \- type `number` \- preferred timezone (defaults to the time zone difference, in minutes, from UTC to current locale (host system settings))
- `category` \- _optional_ \- type `number` \- a number corresponding to a particular category to query within (defaults to all categories), see the [category wiki](https://github.com/pat310/google-trends-api/wiki/Google-Trends-Categories) for a complete list

Optional callback `function` as the second parameter (otherwise returns a promise)

##### Example

Returning top related topics for 'Chipotle' from January 1st, 2015 to February 10th, 2017.

###### Input

```
googleTrends.relatedTopics({keyword: 'Chipotle', startTime: new Date('2015-01-01'), endTime: new Date('2017-02-10')})
.then((res) => {
  console.log(res);
})
.catch((err) => {
  console.log(err);
})
```

###### Output

```
{"default":{"rankedList":[{"rankedKeyword":[{"topic":{"mid":"/m/01b566","title":"Chipotle Mexican Grill","type":"Restaurant company"},"value":100,"formattedValue":"100","link":"/"},{"topic":{"mid":"/m/02f217","title":"Chipotle","type":"Jalape\u00f1o"},"value":5,"formattedValue":"5","link":"/"},\
...\
{"topic":{"mid":"/m/01xg7s","title":"Chorizo","type":"Topic"},"value":0,"formattedValue":"0","link":"/"}]},{"rankedKeyword":[{"topic":{"mid":"/m/09_yl","title":"E. coli","type":"Bacteria"},"value":40700,"formattedValue":"Breakout","link":"/"},\
...\
{"topic":{"mid":"/m/0dqc4","title":"Caridea","type":"Animal"},"value":40,"formattedValue":"+40%","link":"/"}]}]}}
```

[back to top](https://www.npmjs.com/package/google-trends-api#introduction)

* * *

* * *

## Geo help

Unfortunately support is not offered for zip codes at this time. The user must enter a country code, region (or state) code, and/or DMA (Designated Market Area) code.

- A list of country codes can be found here: [country code list](https://github.com/datasets/country-codes/blob/master/data/country-codes.csv)
- A list of DMAs can be found here: [DMA list](https://support.google.com/richmedia/answer/2745487?hl=en)
- A list of available languages can be found here: [language codes](https://sites.google.com/site/tomihasa/google-language-codes)

* * *

## Big Thanks

- To [dreyco676](https://github.com/dreyco676) for the heads up on the deprecated routes and new end points. Checkout the [python google trends](https://github.com/GeneralMills/pytrends)

[back to top](https://www.npmjs.com/package/google-trends-api#introduction)

## Readme

### Keywords

- [google](https://www.npmjs.com/search?q=keywords:google)
- [trends](https://www.npmjs.com/search?q=keywords:trends)
- [API](https://www.npmjs.com/search?q=keywords:API)
- [keyword](https://www.npmjs.com/search?q=keywords:keyword)
- [search](https://www.npmjs.com/search?q=keywords:search)
- [google-trends](https://www.npmjs.com/search?q=keywords:google-trends)

Viewing google-trends-api version 4.9.2